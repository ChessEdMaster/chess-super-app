[{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\3d\\ChessScene.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Environment' is defined but never used.","line":5,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":36}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useMemo } from 'react';\r\nimport { Canvas } from '@react-three/fiber';\r\nimport { OrbitControls, Environment, Stage } from '@react-three/drei';\r\nimport { Chess } from 'chess.js';\r\n\r\ninterface ChessSceneProps {\r\n    fen: string;\r\n    onMove?: (from: string, to: string) => void;\r\n    orientation?: 'white' | 'black';\r\n}\r\n\r\nfunction Board() {\r\n    const squares = useMemo(() => {\r\n        const sq = [];\r\n        for (let i = 0; i < 64; i++) {\r\n            const x = (i % 8) - 3.5;\r\n            const z = Math.floor(i / 8) - 3.5;\r\n            const isBlack = (Math.floor(i / 8) + (i % 8)) % 2 === 1;\r\n            sq.push({ x, z, isBlack, id: i });\r\n        }\r\n        return sq;\r\n    }, []);\r\n\r\n    return (\r\n        <group>\r\n            {squares.map((s) => (\r\n                <mesh key={s.id} position={[s.x, -0.1, s.z]} rotation={[-Math.PI / 2, 0, 0]}>\r\n                    <planeGeometry args={[1, 1]} />\r\n                    <meshStandardMaterial color={s.isBlack ? '#769656' : '#eeeed2'} />\r\n                </mesh>\r\n            ))}\r\n            <mesh position={[0, -0.2, 0]}>\r\n                <boxGeometry args={[8.2, 0.2, 8.2]} />\r\n                <meshStandardMaterial color=\"#333\" />\r\n            </mesh>\r\n        </group>\r\n    );\r\n}\r\n\r\nfunction Pieces({ fen }: { fen: string }) {\r\n    const game = useMemo(() => new Chess(fen), [fen]);\r\n    const board = game.board();\r\n\r\n    const pieces: { type: string; color: string; x: number; z: number; key: string }[] = [];\r\n    board.forEach((row, rowIndex) => {\r\n        row.forEach((square, colIndex) => {\r\n            if (square) {\r\n                pieces.push({\r\n                    type: square.type,\r\n                    color: square.color,\r\n                    x: colIndex - 3.5,\r\n                    z: rowIndex - 3.5,\r\n                    key: `${rowIndex}-${colIndex}`\r\n                });\r\n            }\r\n        });\r\n    });\r\n\r\n    return (\r\n        <group>\r\n            {pieces.map((p) => (\r\n                <mesh key={p.key} position={[p.x, 0.5, p.z]}>\r\n                    <boxGeometry args={[0.6, 1, 0.6]} />\r\n                    <meshStandardMaterial color={p.color === 'w' ? '#fff' : '#222'} />\r\n                </mesh>\r\n            ))}\r\n        </group>\r\n    );\r\n}\r\n\r\nexport default function ChessScene({ fen, orientation = 'white' }: ChessSceneProps) {\r\n    return (\r\n        <div className=\"w-full h-[600px] bg-slate-900 rounded-xl overflow-hidden shadow-2xl\">\r\n            <Canvas shadows camera={{ position: [0, 10, 5], fov: 45 }}>\r\n                <color attach=\"background\" args={['#1a1a1a']} />\r\n                <Stage environment=\"city\" intensity={0.6}>\r\n                    <group rotation={[0, orientation === 'black' ? Math.PI : 0, 0]}>\r\n                        <Board />\r\n                        <Pieces fen={fen} />\r\n                    </group>\r\n                </Stage>\r\n                <OrbitControls makeDefault minPolarAngle={0} maxPolarAngle={Math.PI / 2} />\r\n            </Canvas>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\achievement-badge.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":89,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3349,3352],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3349,3352],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React from 'react';\r\nimport { Trophy, Lock, Unlock } from 'lucide-react';\r\nimport { UserAchievement, AcademyAchievement } from '@/lib/academy-types';\r\n\r\ninterface AchievementBadgeProps {\r\n    achievement: AcademyAchievement;\r\n    unlocked?: boolean;\r\n    unlockedAt?: string;\r\n    size?: 'small' | 'medium' | 'large';\r\n}\r\n\r\nexport function AchievementBadge({\r\n    achievement,\r\n    unlocked = false,\r\n    unlockedAt,\r\n    size = 'medium'\r\n}: AchievementBadgeProps) {\r\n\r\n    const sizeClasses = {\r\n        small: 'w-16 h-16 text-2xl',\r\n        medium: 'w-20 h-20 text-3xl',\r\n        large: 'w-24 h-24 text-4xl'\r\n    };\r\n\r\n    const iconSize = {\r\n        small: 32,\r\n        medium: 40,\r\n        large: 48\r\n    };\r\n\r\n    return (\r\n        <div className={`relative group ${unlocked ? '' : 'opacity-50 grayscale'}`}>\r\n            <div className={`\r\n        ${sizeClasses[size]}\r\n        rounded-xl border-2 \r\n        ${unlocked\r\n                    ? 'bg-gradient-to-br from-amber-500/20 to-orange-500/20 border-amber-500/50'\r\n                    : 'bg-slate-800 border-slate-700'\r\n                }\r\n        flex items-center justify-center\r\n        transition-all duration-300\r\n        ${unlocked ? 'hover:scale-110 hover:shadow-lg hover:shadow-amber-500/20' : ''}\r\n      `}>\r\n                {unlocked ? (\r\n                    <Trophy className=\"text-amber-400\" size={iconSize[size]} />\r\n                ) : (\r\n                    <Lock className=\"text-slate-500\" size={iconSize[size]} />\r\n                )}\r\n            </div>\r\n\r\n            {/* TOOLTIP */}\r\n            <div className=\"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-10\">\r\n                <div className=\"bg-slate-900 border border-slate-700 rounded-lg p-3 shadow-xl min-w-[200px]\">\r\n                    <div className=\"flex items-start gap-2 mb-2\">\r\n                        {unlocked ? (\r\n                            <Unlock className=\"text-emerald-400 flex-shrink-0 mt-0.5\" size={16} />\r\n                        ) : (\r\n                            <Lock className=\"text-slate-500 flex-shrink-0 mt-0.5\" size={16} />\r\n                        )}\r\n                        <div className=\"flex-1\">\r\n                            <h4 className=\"text-sm font-bold text-white mb-1\">\r\n                                {achievement.title}\r\n                            </h4>\r\n                            <p className=\"text-xs text-slate-400\">\r\n                                {achievement.description}\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {unlocked && unlockedAt && (\r\n                        <div className=\"text-xs text-emerald-400 mt-2 pt-2 border-t border-slate-700\">\r\n                            Desbloquejat: {new Date(unlockedAt).toLocaleDateString('ca-ES')}\r\n                        </div>\r\n                    )}\r\n\r\n                    {!unlocked && (\r\n                        <div className=\"text-xs text-slate-500 mt-2 pt-2 border-t border-slate-700\">\r\n                            {getRequirementText(achievement.requirement)}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction getRequirementText(requirement: any): string {\r\n    switch (requirement.type) {\r\n        case 'lessons_completed':\r\n            return `Completa ${requirement.count} lli├ºons`;\r\n        case 'exercises_solved':\r\n            return `Resol ${requirement.count} exercicis`;\r\n        case 'streak_days':\r\n            return `Estudia ${requirement.count} dies seguits`;\r\n        case 'perfect_lesson':\r\n            return 'Completa una lli├º├│ amb puntuaci├│ perfecta';\r\n        case 'module_completed':\r\n            return 'Completa tot el m├▓dul';\r\n        default:\r\n            return 'Requisit desconegut';\r\n    }\r\n}\r\n\r\ninterface AchievementGridProps {\r\n    achievements: AcademyAchievement[];\r\n    userAchievements: UserAchievement[];\r\n}\r\n\r\nexport function AchievementGrid({ achievements, userAchievements }: AchievementGridProps) {\r\n    const unlockedIds = new Set(userAchievements.map(ua => ua.achievement_id));\r\n\r\n    return (\r\n        <div className=\"bg-slate-900 border border-slate-800 rounded-xl p-6\">\r\n            <div className=\"flex items-center gap-2 mb-6\">\r\n                <Trophy className=\"text-amber-400\" size={24} />\r\n                <h2 className=\"text-xl font-bold text-white\">\r\n                    Assoliments\r\n                </h2>\r\n                <span className=\"ml-auto text-sm text-slate-400\">\r\n                    {userAchievements.length} / {achievements.length}\r\n                </span>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-4\">\r\n                {achievements.map((achievement) => {\r\n                    const userAchievement = userAchievements.find(ua => ua.achievement_id === achievement.id);\r\n                    return (\r\n                        <AchievementBadge\r\n                            key={achievement.id}\r\n                            achievement={achievement}\r\n                            unlocked={unlockedIds.has(achievement.id)}\r\n                            unlockedAt={userAchievement?.unlocked_at}\r\n                            size=\"medium\"\r\n                        />\r\n                    );\r\n                })}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\analysis\\opening-explorer.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BookOpen' is defined but never used.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":18},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":106,"column":29,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[5203,5314],"text":"\r\n                        No s&apos;han trobat partides en aquesta posici├│ a la base de dades.\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[5203,5314],"text":"\r\n                        No s&lsquo;han trobat partides en aquesta posici├│ a la base de dades.\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[5203,5314],"text":"\r\n                        No s&#39;han trobat partides en aquesta posici├│ a la base de dades.\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[5203,5314],"text":"\r\n                        No s&rsquo;han trobat partides en aquesta posici├│ a la base de dades.\r\n                    "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { BookOpen, Users, Trophy } from 'lucide-react';\r\n\r\ninterface ExplorerMove {\r\n    uci: string;\r\n    san: string;\r\n    white: number;\r\n    draws: number;\r\n    black: number;\r\n    averageRating: number;\r\n}\r\n\r\ninterface OpeningExplorerProps {\r\n    fen: string;\r\n    onSelectMove: (uci: string) => void;\r\n}\r\n\r\nexport function OpeningExplorer({ fen, onSelectMove }: OpeningExplorerProps) {\r\n    const [moves, setMoves] = useState<ExplorerMove[]>([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [dbSource, setDbSource] = useState<'masters' | 'lichess'>('masters');\r\n\r\n    useEffect(() => {\r\n        const fetchOpeningData = async () => {\r\n            setLoading(true);\r\n            try {\r\n                // Convertim la FEN per ser compatible amb URL\r\n                const cleanFen = fen.replace(/\\s+/g, '_');\r\n                // Lichess API endpoint\r\n                const response = await fetch(`https://explorer.lichess.ovh/${dbSource}?fen=${cleanFen}&moves=10`);\r\n                const data = await response.json();\r\n                setMoves(data.moves || []);\r\n            } catch (error) {\r\n                console.error(\"Error fetching opening data\", error);\r\n                setMoves([]);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        if (fen) fetchOpeningData();\r\n    }, [fen, dbSource]);\r\n\r\n    const getTotalGames = (m: ExplorerMove) => m.white + m.draws + m.black;\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-full bg-slate-900 border border-slate-800 rounded-xl overflow-hidden\">\r\n            {/* Selector de Base de Dades */}\r\n            <div className=\"flex border-b border-slate-800\">\r\n                <button\r\n                    onClick={() => setDbSource('masters')}\r\n                    className={`flex-1 p-3 text-xs font-bold flex items-center justify-center gap-2 ${dbSource === 'masters' ? 'bg-indigo-600 text-white' : 'text-slate-400 hover:bg-slate-800'}`}\r\n                >\r\n                    <Trophy size={14} /> Mestres\r\n                </button>\r\n                <button\r\n                    onClick={() => setDbSource('lichess')}\r\n                    className={`flex-1 p-3 text-xs font-bold flex items-center justify-center gap-2 ${dbSource === 'lichess' ? 'bg-indigo-600 text-white' : 'text-slate-400 hover:bg-slate-800'}`}\r\n                >\r\n                    <Users size={14} /> Lichess\r\n                </button>\r\n            </div>\r\n\r\n            {/* Taula de Moviments */}\r\n            <div className=\"flex-1 overflow-y-auto\">\r\n                <table className=\"w-full text-sm text-left\">\r\n                    <thead className=\"text-xs text-slate-500 bg-slate-800 uppercase\">\r\n                        <tr>\r\n                            <th className=\"px-3 py-2\">Mov</th>\r\n                            <th className=\"px-3 py-2 text-center\">Partides</th>\r\n                            <th className=\"px-3 py-2 text-right\">Win Rate</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"text-slate-300\">\r\n                        {loading ? (\r\n                            <tr><td colSpan={3} className=\"p-4 text-center\">Carregant dades...</td></tr>\r\n                        ) : moves.map((move) => {\r\n                            const total = getTotalGames(move);\r\n                            const whitePct = Math.round((move.white / total) * 100);\r\n                            const drawPct = Math.round((move.draws / total) * 100);\r\n                            const blackPct = Math.round((move.black / total) * 100);\r\n\r\n                            return (\r\n                                <tr key={move.uci}\r\n                                    onClick={() => onSelectMove(move.uci)}\r\n                                    className=\"border-b border-slate-800 hover:bg-slate-800/50 cursor-pointer transition\"\r\n                                >\r\n                                    <td className=\"px-3 py-2 font-bold text-white\">{move.san}</td>\r\n                                    <td className=\"px-3 py-2 text-center text-xs\">{total.toLocaleString()}</td>\r\n                                    <td className=\"px-3 py-2\">\r\n                                        <div className=\"flex h-2 rounded-full overflow-hidden w-full min-w-[60px] bg-slate-700\">\r\n                                            <div style={{ width: `${whitePct}%` }} className=\"bg-gray-200\" title={`Blanques: ${whitePct}%`} />\r\n                                            <div style={{ width: `${drawPct}%` }} className=\"bg-gray-500\" title={`Taules: ${drawPct}%`} />\r\n                                            <div style={{ width: `${blackPct}%` }} className=\"bg-gray-800\" title={`Negres: ${blackPct}%`} />\r\n                                        </div>\r\n                                    </td>\r\n                                </tr>\r\n                            );\r\n                        })}\r\n                    </tbody>\r\n                </table>\r\n                {moves.length === 0 && !loading && (\r\n                    <div className=\"p-6 text-center text-slate-500 text-xs\">\r\n                        No s'han trobat partides en aquesta posici├│ a la base de dades.\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\annotation-panel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Comment' is defined but never used.","line":10,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":44}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Annotation Panel Component\r\n * Edit comments, evaluations, and annotations for moves\r\n */\r\n\r\n'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { MessageSquare, TrendingUp, Palette, Plus, Trash2 } from 'lucide-react';\r\nimport type { MoveNode, Evaluation, Comment } from '@/lib/pgn-types';\r\nimport { NAGSelector, NAGDisplay } from './nag-selector';\r\n\r\ninterface AnnotationPanelProps {\r\n    node: MoveNode | null;\r\n    onAddComment: (text: string, position: 'before' | 'after') => void;\r\n    onUpdateComment: (index: number, text: string) => void;\r\n    onRemoveComment: (index: number) => void;\r\n    onToggleNAG: (nag: number) => void;\r\n    onSetEvaluation: (evaluation: Evaluation | undefined) => void;\r\n}\r\n\r\nexport function AnnotationPanel({\r\n    node,\r\n    onAddComment,\r\n    onUpdateComment,\r\n    onRemoveComment,\r\n    onToggleNAG,\r\n    onSetEvaluation,\r\n}: AnnotationPanelProps) {\r\n    const [activeTab, setActiveTab] = useState<'comments' | 'symbols' | 'evaluation'>('comments');\r\n    const [newComment, setNewComment] = useState('');\r\n    const [evalType, setEvalType] = useState<'cp' | 'mate'>('cp');\r\n    const [evalValue, setEvalValue] = useState('');\r\n\r\n    if (!node) {\r\n        return (\r\n            <div className=\"bg-slate-900 border border-slate-800 rounded-xl p-6 text-center\">\r\n                <MessageSquare className=\"mx-auto mb-2 text-slate-600\" size={32} />\r\n                <p className=\"text-slate-500 text-sm\">\r\n                    Select a move to add annotations\r\n                </p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const handleAddComment = () => {\r\n        if (newComment.trim()) {\r\n            onAddComment(newComment.trim(), 'after');\r\n            setNewComment('');\r\n        }\r\n    };\r\n\r\n    const handleSetEvaluation = () => {\r\n        if (evalValue.trim()) {\r\n            const value = parseFloat(evalValue);\r\n            if (!isNaN(value)) {\r\n                onSetEvaluation({\r\n                    type: evalType,\r\n                    value: evalType === 'cp' ? Math.round(value * 100) : value,\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleClearEvaluation = () => {\r\n        onSetEvaluation(undefined);\r\n        setEvalValue('');\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-slate-900 border border-slate-800 rounded-xl overflow-hidden flex flex-col\">\r\n            {/* Header with Move Info */}\r\n            <div className=\"bg-slate-800 border-b border-slate-700 p-3\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                        <span className=\"text-slate-400 text-xs\">Annotating</span>\r\n                        <div className=\"flex items-center gap-2 mt-1\">\r\n                            <span className=\"text-white font-bold text-lg\">{node.move}</span>\r\n                            <NAGDisplay nags={node.annotation.nags} onRemove={onToggleNAG} />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"text-xs text-slate-500\">\r\n                        Move {node.moveNumber}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Tabs */}\r\n            <div className=\"flex border-b border-slate-700\">\r\n                <button\r\n                    onClick={() => setActiveTab('comments')}\r\n                    className={`flex-1 px-4 py-3 text-sm font-medium transition flex items-center justify-center gap-2 ${activeTab === 'comments'\r\n                            ? 'bg-slate-800 text-indigo-400 border-b-2 border-indigo-500'\r\n                            : 'text-slate-400 hover:text-slate-200 hover:bg-slate-800/50'\r\n                        }`}\r\n                >\r\n                    <MessageSquare size={16} />\r\n                    Comments\r\n                </button>\r\n                <button\r\n                    onClick={() => setActiveTab('symbols')}\r\n                    className={`flex-1 px-4 py-3 text-sm font-medium transition flex items-center justify-center gap-2 ${activeTab === 'symbols'\r\n                            ? 'bg-slate-800 text-indigo-400 border-b-2 border-indigo-500'\r\n                            : 'text-slate-400 hover:text-slate-200 hover:bg-slate-800/50'\r\n                        }`}\r\n                >\r\n                    <Palette size={16} />\r\n                    Symbols\r\n                </button>\r\n                <button\r\n                    onClick={() => setActiveTab('evaluation')}\r\n                    className={`flex-1 px-4 py-3 text-sm font-medium transition flex items-center justify-center gap-2 ${activeTab === 'evaluation'\r\n                            ? 'bg-slate-800 text-indigo-400 border-b-2 border-indigo-500'\r\n                            : 'text-slate-400 hover:text-slate-200 hover:bg-slate-800/50'\r\n                        }`}\r\n                >\r\n                    <TrendingUp size={16} />\r\n                    Evaluation\r\n                </button>\r\n            </div>\r\n\r\n            {/* Content */}\r\n            <div className=\"p-4 flex-1 overflow-y-auto max-h-96\">\r\n                {/* Comments Tab */}\r\n                {activeTab === 'comments' && (\r\n                    <div className=\"space-y-3\">\r\n                        {/* Existing Comments */}\r\n                        {node.annotation.comments.map((comment, index) => (\r\n                            <div\r\n                                key={index}\r\n                                className=\"bg-slate-800 border border-slate-700 rounded-lg p-3 group\"\r\n                            >\r\n                                <div className=\"flex items-start justify-between gap-2\">\r\n                                    <textarea\r\n                                        value={comment.text}\r\n                                        onChange={(e) => onUpdateComment(index, e.target.value)}\r\n                                        className=\"flex-1 bg-transparent text-slate-200 text-sm resize-none outline-none\"\r\n                                        rows={2}\r\n                                    />\r\n                                    <button\r\n                                        onClick={() => onRemoveComment(index)}\r\n                                        className=\"opacity-0 group-hover:opacity-100 p-1 hover:bg-red-500/20 text-red-400 rounded transition\"\r\n                                    >\r\n                                        <Trash2 size={14} />\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n\r\n                        {/* Add New Comment */}\r\n                        <div className=\"space-y-2\">\r\n                            <textarea\r\n                                value={newComment}\r\n                                onChange={(e) => setNewComment(e.target.value)}\r\n                                placeholder=\"Add a comment...\"\r\n                                className=\"w-full bg-slate-800 border border-slate-700 rounded-lg p-3 text-slate-200 text-sm placeholder-slate-500 outline-none focus:border-indigo-500 transition resize-none\"\r\n                                rows={3}\r\n                            />\r\n                            <button\r\n                                onClick={handleAddComment}\r\n                                disabled={!newComment.trim()}\r\n                                className=\"w-full bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white py-2 rounded-lg text-sm font-medium transition flex items-center justify-center gap-2\"\r\n                            >\r\n                                <Plus size={16} />\r\n                                Add Comment\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Symbols Tab */}\r\n                {activeTab === 'symbols' && (\r\n                    <div>\r\n                        <NAGSelector\r\n                            selectedNAGs={node.annotation.nags}\r\n                            onToggleNAG={onToggleNAG}\r\n                        />\r\n                    </div>\r\n                )}\r\n\r\n                {/* Evaluation Tab */}\r\n                {activeTab === 'evaluation' && (\r\n                    <div className=\"space-y-4\">\r\n                        {/* Current Evaluation Display */}\r\n                        {node.annotation.evaluation && (\r\n                            <div className=\"bg-slate-800 border border-slate-700 rounded-lg p-4\">\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <div>\r\n                                        <div className=\"text-xs text-slate-400 mb-1\">Current Evaluation</div>\r\n                                        <div className=\"text-2xl font-bold text-indigo-400\">\r\n                                            {node.annotation.evaluation.type === 'mate'\r\n                                                ? `M${node.annotation.evaluation.value}`\r\n                                                : (node.annotation.evaluation.value / 100).toFixed(2)}\r\n                                        </div>\r\n                                    </div>\r\n                                    <button\r\n                                        onClick={handleClearEvaluation}\r\n                                        className=\"p-2 hover:bg-red-500/20 text-red-400 rounded transition\"\r\n                                    >\r\n                                        <Trash2 size={16} />\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Set Evaluation */}\r\n                        <div className=\"space-y-3\">\r\n                            <div>\r\n                                <label className=\"text-xs text-slate-400 mb-2 block\">Evaluation Type</label>\r\n                                <div className=\"flex gap-2\">\r\n                                    <button\r\n                                        onClick={() => setEvalType('cp')}\r\n                                        className={`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition ${evalType === 'cp'\r\n                                                ? 'bg-indigo-600 text-white'\r\n                                                : 'bg-slate-800 text-slate-400 hover:bg-slate-700'\r\n                                            }`}\r\n                                    >\r\n                                        Centipawns\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => setEvalType('mate')}\r\n                                        className={`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition ${evalType === 'mate'\r\n                                                ? 'bg-indigo-600 text-white'\r\n                                                : 'bg-slate-800 text-slate-400 hover:bg-slate-700'\r\n                                            }`}\r\n                                    >\r\n                                        Mate\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"text-xs text-slate-400 mb-2 block\">\r\n                                    Value {evalType === 'cp' ? '(e.g., 1.5 for +1.50)' : '(moves to mate)'}\r\n                                </label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    step={evalType === 'cp' ? '0.1' : '1'}\r\n                                    value={evalValue}\r\n                                    onChange={(e) => setEvalValue(e.target.value)}\r\n                                    placeholder={evalType === 'cp' ? '0.0' : '0'}\r\n                                    className=\"w-full bg-slate-800 border border-slate-700 rounded-lg p-3 text-slate-200 text-sm placeholder-slate-500 outline-none focus:border-indigo-500 transition\"\r\n                                />\r\n                            </div>\r\n\r\n                            <button\r\n                                onClick={handleSetEvaluation}\r\n                                disabled={!evalValue.trim()}\r\n                                className=\"w-full bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white py-2 rounded-lg text-sm font-medium transition\"\r\n                            >\r\n                                Set Evaluation\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Info */}\r\n                        <div className=\"bg-slate-800/50 border border-slate-700/50 rounded-lg p-3\">\r\n                            <p className=\"text-xs text-slate-400\">\r\n                                ­ƒÆí Positive values favor White, negative values favor Black\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\auth-provider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\chat-box.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'username' is defined but never used.","line":13,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":51},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[389,392],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[389,392],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useEffect, useState, useRef } from 'react';\r\nimport { supabase } from '@/lib/supabase';\r\nimport { Send, MessageSquare } from 'lucide-react';\r\n\r\ninterface ChatBoxProps {\r\n    gameId: string;\r\n    userId: string;\r\n    username: string;\r\n}\r\n\r\nexport function ChatBox({ gameId, userId, username }: ChatBoxProps) {\r\n    const [messages, setMessages] = useState<any[]>([]);\r\n    const [newMessage, setNewMessage] = useState('');\r\n    const scrollRef = useRef<HTMLDivElement>(null);\r\n\r\n    useEffect(() => {\r\n        // Carregar missatges antics\r\n        const fetchMessages = async () => {\r\n            try {\r\n                // Primero obtener los mensajes\r\n                const { data: messagesData, error: messagesError } = await supabase\r\n                    .from('messages')\r\n                    .select('*')\r\n                    .eq('game_id', gameId)\r\n                    .order('created_at', { ascending: true });\r\n\r\n                if (messagesError) {\r\n                    console.error('[ChatBox] Error fetching messages:', messagesError);\r\n                    return;\r\n                }\r\n\r\n                if (!messagesData) return;\r\n\r\n                // Luego obtener los perfiles para cada mensaje\r\n                const messagesWithProfiles = await Promise.all(\r\n                    messagesData.map(async (msg) => {\r\n                        try {\r\n                            const { data: profile, error: profileError } = await supabase\r\n                                .from('profiles')\r\n                                .select('username')\r\n                                .eq('id', msg.user_id)\r\n                                .single();\r\n                            \r\n                            if (profileError) {\r\n                                console.warn('[ChatBox] Error fetching profile for user:', msg.user_id, profileError);\r\n                            }\r\n                            \r\n                            return {\r\n                                ...msg,\r\n                                profiles: profile ? { username: profile.username } : null\r\n                            };\r\n                        } catch (error) {\r\n                            console.error('[ChatBox] Error processing message:', error);\r\n                            return {\r\n                                ...msg,\r\n                                profiles: null\r\n                            };\r\n                        }\r\n                    })\r\n                );\r\n\r\n                setMessages(messagesWithProfiles);\r\n            } catch (error) {\r\n                console.error('[ChatBox] Error in fetchMessages:', error);\r\n            }\r\n        };\r\n\r\n        fetchMessages();\r\n\r\n        // Subscripci├│ Realtime\r\n        const channel = supabase\r\n            .channel(`chat_${gameId}`)\r\n            .on('postgres_changes', { event: 'INSERT', schema: 'public', table: 'messages', filter: `game_id=eq.${gameId}` }, async (payload) => {\r\n                const newMsg = payload.new;\r\n                // Necessitem el username, que no ve al payload directe\r\n                const { data: profile } = await supabase.from('profiles').select('username').eq('id', newMsg.user_id).single();\r\n                setMessages((prev) => [...prev, { ...newMsg, profiles: profile }]);\r\n            })\r\n            .subscribe();\r\n\r\n        return () => { supabase.removeChannel(channel); };\r\n    }, [gameId]);\r\n\r\n    // Auto-scroll\r\n    useEffect(() => {\r\n        if (scrollRef.current) {\r\n            scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\r\n        }\r\n    }, [messages]);\r\n\r\n    const sendMessage = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!newMessage.trim()) return;\r\n\r\n        const msg = newMessage.trim();\r\n        setNewMessage(''); // Optimistic clear\r\n\r\n        await supabase.from('messages').insert({\r\n            game_id: gameId,\r\n            user_id: userId,\r\n            content: msg\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-[300px] bg-slate-900 rounded-xl border border-slate-800 overflow-hidden\">\r\n            <div className=\"p-3 bg-slate-800 border-b border-slate-700 font-bold text-slate-300 text-sm flex items-center gap-2\">\r\n                <MessageSquare size={16} /> Xat de la Partida\r\n            </div>\r\n\r\n            <div ref={scrollRef} className=\"flex-1 overflow-y-auto p-3 space-y-2 scrollbar-thin scrollbar-thumb-slate-700\">\r\n                {messages.length === 0 && <p className=\"text-slate-600 text-xs text-center italic mt-10\">Digues hola al teu rival! ­ƒæï</p>}\r\n                {messages.map((msg) => {\r\n                    const isMe = msg.user_id === userId;\r\n                    return (\r\n                        <div key={msg.id} className={`flex flex-col ${isMe ? 'items-end' : 'items-start'}`}>\r\n                            <div className={`max-w-[85%] px-3 py-2 rounded-lg text-sm ${isMe ? 'bg-indigo-600 text-white rounded-br-none' : 'bg-slate-800 text-slate-200 rounded-bl-none'}`}>\r\n                                {msg.content}\r\n                            </div>\r\n                            <span className=\"text-[10px] text-slate-500 mt-1 px-1\">\r\n                                {isMe ? 'Tu' : msg.profiles?.username || 'Rival'}\r\n                            </span>\r\n                        </div>\r\n                    );\r\n                })}\r\n            </div>\r\n\r\n            <form onSubmit={sendMessage} className=\"p-2 bg-slate-800 border-t border-slate-700 flex gap-2\">\r\n                <input\r\n                    type=\"text\"\r\n                    value={newMessage}\r\n                    onChange={(e) => setNewMessage(e.target.value)}\r\n                    placeholder=\"Escriu un missatge...\"\r\n                    className=\"flex-1 bg-slate-900 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-indigo-500 transition\"\r\n                />\r\n                <button type=\"submit\" className=\"bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition\">\r\n                    <Send size={18} />\r\n                </button>\r\n            </form>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\chess-clock.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\chess-clock.tsx:20:5\n  18 |   // Sincronitzar quan canvien les props (ve del servidor)\n  19 |   useEffect(() => {\n> 20 |     setWTime(whiteTime);\n     |     ^^^^^^^^ Avoid calling setState() directly within an effect\n  21 |     setBTime(blackTime);\n  22 |   }, [whiteTime, blackTime]);\n  23 |","line":20,"column":5,"nodeType":null,"endLine":20,"endColumn":13}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Clock } from 'lucide-react';\r\n\r\ninterface ChessClockProps {\r\n  whiteTime: number; // Segons\r\n  blackTime: number; // Segons\r\n  turn: 'w' | 'b';\r\n  isActive: boolean; // Si la partida est├á en marxa\r\n  onTimeout: (winner: 'w' | 'b') => void;\r\n}\r\n\r\nexport function ChessClock({ whiteTime, blackTime, turn, isActive, onTimeout }: ChessClockProps) {\r\n  const [wTime, setWTime] = useState(whiteTime);\r\n  const [bTime, setBTime] = useState(blackTime);\r\n\r\n  // Sincronitzar quan canvien les props (ve del servidor)\r\n  useEffect(() => {\r\n    setWTime(whiteTime);\r\n    setBTime(blackTime);\r\n  }, [whiteTime, blackTime]);\r\n\r\n  useEffect(() => {\r\n    if (!isActive) return;\r\n\r\n    const interval = setInterval(() => {\r\n      if (turn === 'w') {\r\n        setWTime((prev) => {\r\n          if (prev <= 0) {\r\n            clearInterval(interval);\r\n            onTimeout('b');\r\n            return 0;\r\n          }\r\n          return prev - 1;\r\n        });\r\n      } else {\r\n        setBTime((prev) => {\r\n          if (prev <= 0) {\r\n            clearInterval(interval);\r\n            onTimeout('w');\r\n            return 0;\r\n          }\r\n          return prev - 1;\r\n        });\r\n      }\r\n    }, 1000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [turn, isActive, onTimeout]);\r\n\r\n  const formatTime = (seconds: number) => {\r\n    const m = Math.floor(seconds / 60);\r\n    const s = seconds % 60;\r\n    return `${m}:${s.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex gap-4 w-full\">\r\n      <div className={`flex-1 p-3 rounded-lg flex items-center justify-between border-2 transition-all ${turn === 'w' ? 'bg-slate-100 border-amber-500 shadow-[0_0_15px_rgba(245,158,11,0.3)]' : 'bg-slate-200 border-transparent opacity-60'}`}>\r\n        <div className=\"flex items-center gap-2 text-slate-800 font-bold\">\r\n          <Clock size={18} />\r\n          <span>BLANQUES</span>\r\n        </div>\r\n        <span className=\"font-mono text-2xl font-black text-slate-900\">{formatTime(wTime)}</span>\r\n      </div>\r\n\r\n      <div className={`flex-1 p-3 rounded-lg flex items-center justify-between border-2 transition-all ${turn === 'b' ? 'bg-slate-800 border-amber-500 shadow-[0_0_15px_rgba(245,158,11,0.3)]' : 'bg-slate-900 border-transparent opacity-60'}`}>\r\n        <div className=\"flex items-center gap-2 text-slate-200 font-bold\">\r\n          <Clock size={18} />\r\n          <span>NEGRES</span>\r\n        </div>\r\n        <span className=\"font-mono text-2xl font-black text-white\">{formatTime(bTime)}</span>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\coach-agent.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\coach-agent.tsx:19:13\n  17 |     useEffect(() => {\n  18 |         if (!evaluation || !previousEval || !currentMove) {\n> 19 |             setMessage(\"Fes un moviment per comen├ºar l'an├álisi...\");\n     |             ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  20 |             setSeverity('neutral');\n  21 |             return;\n  22 |         }","line":19,"column":13,"nodeType":null,"endLine":19,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Brain, TrendingDown, AlertCircle, CheckCircle, Lightbulb } from 'lucide-react';\r\n\r\ninterface CoachAgentProps {\r\n    evaluation: { type: 'cp' | 'mate', value: number } | null;\r\n    previousEval: { type: 'cp' | 'mate', value: number } | null;\r\n    currentMove: string | null;\r\n    turn: 'w' | 'b';\r\n}\r\n\r\nexport function CoachAgent({ evaluation, previousEval, currentMove, turn }: CoachAgentProps) {\r\n    const [message, setMessage] = useState<string>('');\r\n    const [severity, setSeverity] = useState<'good' | 'neutral' | 'mistake' | 'blunder'>('neutral');\r\n\r\n    useEffect(() => {\r\n        if (!evaluation || !previousEval || !currentMove) {\r\n            setMessage(\"Fes un moviment per comen├ºar l'an├álisi...\");\r\n            setSeverity('neutral');\r\n            return;\r\n        }\r\n\r\n        // Calcular difer├¿ncia d'avaluaci├│ (des del punt de vista del jugador que acaba de moure)\r\n        const prevScore = previousEval.type === 'mate' ? (previousEval.value > 0 ? 10000 : -10000) : previousEval.value;\r\n        const currScore = evaluation.type === 'mate' ? (evaluation.value > 0 ? 10000 : -10000) : evaluation.value;\r\n\r\n        // Ajustar segons qui ha mogut (si negres han mogut, invertim)\r\n        const actualPrev = turn === 'b' ? -prevScore : prevScore;\r\n        const actualCurr = turn === 'b' ? -currScore : currScore;\r\n\r\n        const evalDrop = actualPrev - actualCurr; // Positiu = has perdut avantatge\r\n\r\n        // Classificar el moviment\r\n        if (evalDrop < -50) {\r\n            setMessage(`­ƒÆÄ Excel┬Àlent! Has guanyat ${Math.abs(evalDrop / 100).toFixed(1)} punts d'avantatge.`);\r\n            setSeverity('good');\r\n        } else if (evalDrop < 50) {\r\n            setMessage(`Ô£ô Moviment correcte. La posici├│ es mant├® equilibrada.`);\r\n            setSeverity('neutral');\r\n        } else if (evalDrop < 150) {\r\n            setMessage(`ÔÜá´©Å Petit error. Has perdut ${(evalDrop / 100).toFixed(1)} punts. Revisa les alternatives.`);\r\n            setSeverity('mistake');\r\n        } else {\r\n            setMessage(`ÔØî Blunder! Has perdut ${(evalDrop / 100).toFixed(1)} punts. Aix├▓ pot costar la partida.`);\r\n            setSeverity('blunder');\r\n        }\r\n    }, [evaluation, previousEval, currentMove, turn]);\r\n\r\n    const bgColor = {\r\n        good: 'bg-emerald-900/30 border-emerald-500/50',\r\n        neutral: 'bg-slate-800 border-slate-700',\r\n        mistake: 'bg-amber-900/30 border-amber-500/50',\r\n        blunder: 'bg-red-900/30 border-red-500/50'\r\n    }[severity];\r\n\r\n    const icon = {\r\n        good: <CheckCircle size={18} className=\"text-emerald-400\" />,\r\n        neutral: <Brain size={18} className=\"text-slate-400\" />,\r\n        mistake: <AlertCircle size={18} className=\"text-amber-400\" />,\r\n        blunder: <TrendingDown size={18} className=\"text-red-400\" />\r\n    }[severity];\r\n\r\n    return (\r\n        <div className={`${bgColor} border p-4 rounded-xl transition-all duration-300`}>\r\n            <div className=\"flex items-start gap-3\">\r\n                <div className=\"mt-0.5\">{icon}</div>\r\n                <div className=\"flex-1\">\r\n                    <div className=\"flex items-center gap-2 mb-1\">\r\n                        <Lightbulb size={14} className=\"text-indigo-400\" />\r\n                        <h3 className=\"text-xs font-bold text-slate-400 uppercase tracking-wider\">Entrenador IA</h3>\r\n                    </div>\r\n                    <p className=\"text-sm text-slate-200 leading-relaxed\">{message}</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\game-layout\\bottom-nav.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\lesson-viewer.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\lesson-viewer.tsx:50:13\n  48 |         if (currentStep) {\n  49 |             const newGame = new Chess(currentStep.fen);\n> 50 |             setGame(newGame);\n     |             ^^^^^^^ Avoid calling setState() directly within an effect\n  51 |             setFen(currentStep.fen);\n  52 |             setFeedback(null);\n  53 |             setShowHint(false);","line":50,"column":13,"nodeType":null,"endLine":50,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":102,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":102,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":109,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":109,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3637,3640],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3637,3640],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":119,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":119,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3972,3975],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3972,3975],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":120,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4030,4033],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4030,4033],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":159,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":159,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5431,5434],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5431,5434],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":171,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":171,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5850,5853],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5850,5853],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":293,"column":119,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[11353,11531],"text":"\r\n                                    Busca moviments que segueixin la instrucci├│. Pensa en la seguretat del teu rei i l&apos;activitat de les peces.\r\n                                "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[11353,11531],"text":"\r\n                                    Busca moviments que segueixin la instrucci├│. Pensa en la seguretat del teu rei i l&lsquo;activitat de les peces.\r\n                                "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[11353,11531],"text":"\r\n                                    Busca moviments que segueixin la instrucci├│. Pensa en la seguretat del teu rei i l&#39;activitat de les peces.\r\n                                "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[11353,11531],"text":"\r\n                                    Busca moviments que segueixin la instrucci├│. Pensa en la seguretat del teu rei i l&rsquo;activitat de les peces.\r\n                                "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Chess } from 'chess.js';\r\nimport { Chessboard } from 'react-chessboard';\r\nimport {\r\n    ChevronLeft,\r\n    ChevronRight,\r\n    CheckCircle,\r\n    XCircle,\r\n    Lightbulb,\r\n    Trophy,\r\n    RotateCcw\r\n} from 'lucide-react';\r\nimport { LessonContent } from '@/lib/academy-types';\r\nimport { useSettings } from '@/lib/settings';\r\nimport { BOARD_THEMES } from '@/lib/themes';\r\nimport { playSound } from '@/lib/sounds';\r\n\r\ninterface LessonViewerProps {\r\n    content: LessonContent;\r\n    onComplete: (score: number) => void;\r\n    lessonTitle: string;\r\n}\r\n\r\nexport function LessonViewer({ content, onComplete, lessonTitle }: LessonViewerProps) {\r\n    const [currentStepIndex, setCurrentStepIndex] = useState(0);\r\n    const [game, setGame] = useState<Chess>(new Chess());\r\n    const [fen, setFen] = useState('');\r\n    const [feedback, setFeedback] = useState<{ type: 'success' | 'error' | 'info'; message: string } | null>(null);\r\n    const [correctMoves, setCorrectMoves] = useState(0);\r\n    const [totalAttempts, setTotalAttempts] = useState(0);\r\n    const [isCompleted, setIsCompleted] = useState(false);\r\n    const [showHint, setShowHint] = useState(false);\r\n\r\n    // Click to move state\r\n    const [moveFrom, setMoveFrom] = useState<string | null>(null);\r\n    const [optionSquares, setOptionSquares] = useState<Record<string, { background: string; borderRadius?: string }>>({});\r\n\r\n    const { boardTheme } = useSettings();\r\n    const theme = BOARD_THEMES[boardTheme];\r\n\r\n    const currentStep = content.steps[currentStepIndex];\r\n    const isLastStep = currentStepIndex === content.steps.length - 1;\r\n    const isFirstStep = currentStepIndex === 0;\r\n\r\n    useEffect(() => {\r\n        if (currentStep) {\r\n            const newGame = new Chess(currentStep.fen);\r\n            setGame(newGame);\r\n            setFen(currentStep.fen);\r\n            setFeedback(null);\r\n            setShowHint(false);\r\n        }\r\n    }, [currentStepIndex, currentStep]);\r\n\r\n    const handleMove = (sourceSquare: string, targetSquare: string) => {\r\n        if (isCompleted) return false;\r\n\r\n        const gameCopy = new Chess(game.fen());\r\n\r\n        try {\r\n            const result = gameCopy.move({\r\n                from: sourceSquare,\r\n                to: targetSquare,\r\n                promotion: 'q'\r\n            });\r\n\r\n            if (!result) return false;\r\n\r\n            const uciMove = `${sourceSquare}${targetSquare}`;\r\n            setTotalAttempts(prev => prev + 1);\r\n\r\n            if (currentStep.correctMoves.includes(uciMove)) {\r\n                setCorrectMoves(prev => prev + 1);\r\n                setFeedback({\r\n                    type: 'success',\r\n                    message: currentStep.explanation\r\n                });\r\n                playSound('move');\r\n\r\n                setGame(gameCopy);\r\n                setFen(gameCopy.fen());\r\n\r\n                setTimeout(() => {\r\n                    if (isLastStep) {\r\n                        completeLesson();\r\n                    } else {\r\n                        nextStep();\r\n                    }\r\n                }, 2000);\r\n\r\n                return true;\r\n            } else {\r\n                setFeedback({\r\n                    type: 'error',\r\n                    message: 'Aquest no ├®s el millor moviment. Torna-ho a intentar!'\r\n                });\r\n                playSound('illegal');\r\n                return false;\r\n            }\r\n        } catch (error) {\r\n            return false;\r\n        }\r\n    };\r\n\r\n    function getMoveOptions(square: string) {\r\n        const moves = game.moves({\r\n            square: square as any,\r\n            verbose: true,\r\n        });\r\n        if (moves.length === 0) {\r\n            setOptionSquares({});\r\n            return false;\r\n        }\r\n\r\n        const newSquares: Record<string, { background: string; borderRadius?: string }> = {};\r\n        moves.map((move) => {\r\n            const targetPiece = game.get(move.to as any);\r\n            const sourcePiece = game.get(square as any);\r\n            const isCapture = targetPiece && sourcePiece && targetPiece.color !== sourcePiece.color;\r\n\r\n            newSquares[move.to] = {\r\n                background: isCapture\r\n                    ? 'radial-gradient(circle, rgba(255,0,0,.5) 25%, transparent 25%)'\r\n                    : 'radial-gradient(circle, rgba(0,0,0,.5) 25%, transparent 25%)',\r\n                borderRadius: '50%',\r\n            };\r\n            return move;\r\n        });\r\n        newSquares[square] = {\r\n            background: 'rgba(255, 255, 0, 0.4)',\r\n        };\r\n        setOptionSquares(newSquares);\r\n        return true;\r\n    }\r\n\r\n    function onSquareClick(square: string) {\r\n        if (isCompleted) return;\r\n\r\n        // If we have a moveFrom, try to move to the clicked square\r\n        if (moveFrom) {\r\n            // If clicked on the same square, deselect\r\n            if (moveFrom === square) {\r\n                setMoveFrom(null);\r\n                setOptionSquares({});\r\n                return;\r\n            }\r\n\r\n            // Attempt move\r\n            const moveResult = handleMove(moveFrom, square);\r\n            if (moveResult) {\r\n                setMoveFrom(null);\r\n                setOptionSquares({});\r\n                return;\r\n            }\r\n\r\n            // If move failed, check if we clicked on another piece of our own to select it instead\r\n            const clickedPiece = game.get(square as any);\r\n            if (clickedPiece && clickedPiece.color === game.turn()) {\r\n                setMoveFrom(square);\r\n                getMoveOptions(square);\r\n                return;\r\n            }\r\n\r\n            // Otherwise, just deselect\r\n            setMoveFrom(null);\r\n            setOptionSquares({});\r\n        } else {\r\n            // No piece selected, try to select\r\n            const piece = game.get(square as any);\r\n            if (piece && piece.color === game.turn()) {\r\n                setMoveFrom(square);\r\n                getMoveOptions(square);\r\n            }\r\n        }\r\n    }\r\n\r\n    const nextStep = () => {\r\n        if (!isLastStep) {\r\n            setCurrentStepIndex(prev => prev + 1);\r\n        }\r\n    };\r\n\r\n    const previousStep = () => {\r\n        if (!isFirstStep) {\r\n            setCurrentStepIndex(prev => prev - 1);\r\n        }\r\n    };\r\n\r\n    const resetStep = () => {\r\n        const newGame = new Chess(currentStep.fen);\r\n        setGame(newGame);\r\n        setFen(currentStep.fen);\r\n        setFeedback(null);\r\n        setShowHint(false);\r\n    };\r\n\r\n    const completeLesson = () => {\r\n        const score = Math.round((correctMoves / Math.max(totalAttempts, 1)) * 100);\r\n        setIsCompleted(true);\r\n        setFeedback({\r\n            type: 'success',\r\n            message: content.conclusion || '­ƒÄë Has completat la lli├º├│!'\r\n        });\r\n        playSound('game_end');\r\n        onComplete(score);\r\n    };\r\n\r\n    const toggleHint = () => {\r\n        setShowHint(!showHint);\r\n    };\r\n\r\n    return (\r\n        <div className=\"w-full max-w-6xl mx-auto p-4\">\r\n            <div className=\"flex flex-col lg:flex-row gap-6\">\r\n\r\n                <div className=\"flex-1\">\r\n                    <div className=\"relative w-full max-w-[600px] aspect-square mx-auto shadow-2xl rounded-lg overflow-hidden border-4 border-slate-800 bg-slate-900\">\r\n                        <Chessboard\r\n                            id={`lesson-${currentStepIndex}`}\r\n                            position={fen}\r\n                            onPieceDrop={({ sourceSquare, targetSquare }) => {\r\n                                if (!targetSquare) return false;\r\n                                return handleMove(sourceSquare, targetSquare);\r\n                            }}\r\n                            boardOrientation=\"white\"\r\n                            customDarkSquareStyle={{ backgroundColor: theme.dark }}\r\n                            customLightSquareStyle={{ backgroundColor: theme.light }}\r\n                            arePiecesDraggable={!isCompleted}\r\n                            onSquareClick={onSquareClick}\r\n                            onSquareRightClick={() => {\r\n                                setMoveFrom(null);\r\n                                setOptionSquares({});\r\n                            }}\r\n                            customSquareStyles={optionSquares}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"mt-4 max-w-[600px] mx-auto\">\r\n                        <div className=\"flex items-center justify-between mb-2\">\r\n                            <span className=\"text-sm text-slate-400\">\r\n                                Pas {currentStepIndex + 1} de {content.steps.length}\r\n                            </span>\r\n                            <span className=\"text-sm text-slate-400\">\r\n                                Precisi├│: {totalAttempts > 0 ? Math.round((correctMoves / totalAttempts) * 100) : 0}%\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"w-full bg-slate-800 h-2 rounded-full overflow-hidden\">\r\n                            <div\r\n                                className=\"bg-indigo-500 h-full transition-all duration-300\"\r\n                                style={{ width: `${((currentStepIndex + 1) / content.steps.length) * 100}%` }}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"w-full lg:w-96 flex flex-col gap-4\">\r\n\r\n                    <div className=\"bg-slate-900 border border-slate-800 rounded-xl p-6\">\r\n                        <h2 className=\"text-2xl font-bold text-white mb-2\">{lessonTitle}</h2>\r\n                        {isFirstStep && content.introduction && (\r\n                            <p className=\"text-slate-400 text-sm mb-4\">{content.introduction}</p>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"bg-slate-900 border border-slate-800 rounded-xl p-6\">\r\n                        <div className=\"flex items-start gap-3 mb-4\">\r\n                            <Lightbulb className=\"text-amber-400 mt-1\" size={20} />\r\n                            <div>\r\n                                <h3 className=\"text-sm font-bold text-slate-400 uppercase tracking-wider mb-2\">\r\n                                    Instrucci├│\r\n                                </h3>\r\n                                <p className=\"text-white text-base leading-relaxed\">\r\n                                    {currentStep.instruction}\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {!isCompleted && (\r\n                            <button\r\n                                onClick={toggleHint}\r\n                                className=\"text-sm text-indigo-400 hover:text-indigo-300 flex items-center gap-2 transition\"\r\n                            >\r\n                                <Lightbulb size={16} />\r\n                                {showHint ? 'Amagar pista' : 'Mostrar pista'}\r\n                            </button>\r\n                        )}\r\n\r\n                        {showHint && (\r\n                            <div className=\"mt-3 p-3 bg-indigo-900/20 border border-indigo-500/30 rounded-lg\">\r\n                                <p className=\"text-sm text-indigo-200\">\r\n                                    Busca moviments que segueixin la instrucci├│. Pensa en la seguretat del teu rei i l'activitat de les peces.\r\n                                </p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {feedback && (\r\n                        <div className={`border rounded-xl p-4 ${feedback.type === 'success'\r\n                            ? 'bg-emerald-900/20 border-emerald-500/30'\r\n                            : feedback.type === 'error'\r\n                                ? 'bg-red-900/20 border-red-500/30'\r\n                                : 'bg-blue-900/20 border-blue-500/30'\r\n                            }`}>\r\n                            <div className=\"flex items-start gap-3\">\r\n                                {feedback.type === 'success' ? (\r\n                                    <CheckCircle className=\"text-emerald-400 mt-0.5\" size={20} />\r\n                                ) : feedback.type === 'error' ? (\r\n                                    <XCircle className=\"text-red-400 mt-0.5\" size={20} />\r\n                                ) : (\r\n                                    <Lightbulb className=\"text-blue-400 mt-0.5\" size={20} />\r\n                                )}\r\n                                <p className={`text-sm ${feedback.type === 'success'\r\n                                    ? 'text-emerald-200'\r\n                                    : feedback.type === 'error'\r\n                                        ? 'text-red-200'\r\n                                        : 'text-blue-200'\r\n                                    }`}>\r\n                                    {feedback.message}\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    <div className=\"flex gap-3\">\r\n                        <button\r\n                            onClick={previousStep}\r\n                            disabled={isFirstStep}\r\n                            className=\"flex-1 bg-slate-800 hover:bg-slate-700 disabled:opacity-30 disabled:cursor-not-allowed text-white py-3 rounded-lg font-bold flex items-center justify-center gap-2 transition\"\r\n                        >\r\n                            <ChevronLeft size={20} />\r\n                            Anterior\r\n                        </button>\r\n\r\n                        <button\r\n                            onClick={resetStep}\r\n                            className=\"bg-slate-800 hover:bg-slate-700 text-white p-3 rounded-lg transition\"\r\n                            title=\"Reiniciar pas\"\r\n                        >\r\n                            <RotateCcw size={20} />\r\n                        </button>\r\n\r\n                        {!isCompleted && !isLastStep && (\r\n                            <button\r\n                                onClick={nextStep}\r\n                                className=\"flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-lg font-bold flex items-center justify-center gap-2 transition\"\r\n                            >\r\n                                Seg├╝ent\r\n                                <ChevronRight size={20} />\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n\r\n                    {isCompleted && (\r\n                        <div className=\"bg-gradient-to-r from-indigo-900/40 to-purple-900/40 border border-indigo-500/50 rounded-xl p-6 text-center\">\r\n                            <Trophy className=\"text-amber-400 mx-auto mb-3\" size={48} />\r\n                            <h3 className=\"text-xl font-bold text-white mb-2\">\r\n                                Lli├º├│ Completada!\r\n                            </h3>\r\n                            <p className=\"text-slate-300 text-sm mb-4\">\r\n                                Puntuaci├│: {Math.round((correctMoves / Math.max(totalAttempts, 1)) * 100)}%\r\n                            </p>\r\n                            <div className=\"text-xs text-slate-400\">\r\n                                Moviments correctes: {correctMoves} / {totalAttempts}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\move-history.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1339,1342],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1339,1342],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useEffect, useRef } from 'react';\r\n\r\ninterface MoveHistoryProps {\r\n    history: string[];\r\n}\r\n\r\nexport function MoveHistory({ history }: MoveHistoryProps) {\r\n    const scrollRef = useRef<HTMLDivElement>(null);\r\n\r\n    useEffect(() => {\r\n        if (scrollRef.current) {\r\n            scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\r\n        }\r\n    }, [history]);\r\n\r\n    return (\r\n        <div className=\"flex-1 bg-slate-900 rounded-xl border border-slate-800 overflow-hidden flex flex-col relative h-full min-h-[200px]\">\r\n            <div className=\"absolute top-0 left-0 right-0 h-8 bg-gradient-to-b from-slate-900 to-transparent pointer-events-none\"></div>\r\n            <div className=\"p-3 bg-slate-800 border-b border-slate-700 font-bold text-slate-300 text-sm flex justify-between items-center shadow-md z-10\">\r\n                <span>Historial</span>\r\n                <span className=\"text-[10px] bg-slate-950 px-1.5 py-0.5 rounded text-slate-500 border border-slate-800\">PGN</span>\r\n            </div>\r\n            <div ref={scrollRef} className=\"flex-1 overflow-y-auto p-2 font-mono text-xs sm:text-sm scrollbar-thin scrollbar-thumb-slate-700 scrollbar-track-slate-900\">\r\n                <div className=\"grid grid-cols-[30px_1fr_1fr] gap-y-1\">\r\n                    {history.reduce((rows: any[], move, index) => {\r\n                        if (index % 2 === 0) {\r\n                            rows.push([`${(index / 2) + 1}.`, move]);\r\n                        } else {\r\n                            rows[rows.length - 1].push(move);\r\n                        }\r\n                        return rows;\r\n                    }, []).map((row, i) => (\r\n                        <React.Fragment key={i}>\r\n                            <div className=\"text-slate-500 text-right pr-2\">{row[0]}</div>\r\n                            <div className=\"bg-slate-800/50 rounded px-2 py-1 text-slate-300 hover:bg-slate-700 transition-colors cursor-pointer text-center\">{row[1]}</div>\r\n                            <div className=\"bg-slate-800/50 rounded px-2 py-1 text-slate-300 hover:bg-slate-700 transition-colors cursor-pointer text-center\">{row[2] || ''}</div>\r\n                        </React.Fragment>\r\n                    ))}\r\n                </div>\r\n                {history.length === 0 && <div className=\"flex flex-col items-center justify-center h-full text-slate-600 text-xs gap-2 opacity-50\"><span>Esperant moviments...</span></div>}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\nag-selector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\pgn-editor.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used.","line":15,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Settings' is defined but never used.","line":16,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PGNOptimizer' is defined but never used.","line":20,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":33},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'currentMove' is defined but never used.","line":38,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":38,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setShowAnnotationPanel' is assigned a value but never used.","line":43,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":43,"endColumn":55},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'currentNode'. Either include it or remove the dependency array.","line":58,"column":8,"nodeType":"ArrayExpression","endLine":58,"endColumn":71,"suggestions":[{"desc":"Update the dependencies array to be: [engineEval, currentNode.id, autoAnnotate, tree, onTreeChange, currentNode]","fix":{"range":[1736,1799],"text":"[engineEval, currentNode.id, autoAnnotate, tree, onTreeChange, currentNode]"}}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot modify local variables after render completes\n\nThis argument is a function which may reassign or mutate `currentNode` after render, which can cause inconsistent behavior on subsequent renders. Consider using state instead.\n\nC:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\pgn-editor.tsx:290:38\n  288 |                     onRemoveComment={handleRemoveComment}\n  289 |                     onToggleNAG={handleToggleNAG}\n> 290 |                     onSetEvaluation={handleSetEvaluation}\n      |                                      ^^^^^^^^^^^^^^^^^^^ This function may (indirectly) reassign or modify `currentNode` after render\n  291 |                 />\n  292 |             )}\n  293 |\n\nC:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\pgn-editor.tsx:102:17\n  100 |             // Clear evaluation\n  101 |             if (currentNode) {\n> 102 |                 currentNode.annotation.evaluation = undefined;\n      |                 ^^^^^^^^^^^^^^^^^^^^^^ This modifies `currentNode`\n  103 |             }\n  104 |         }\n  105 |         onTreeChange(tree);","line":290,"column":38,"nodeType":null,"endLine":290,"endColumn":57}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * PGN Editor Component\r\n * Main editor for managing PGN games with variations and annotations\r\n */\r\n\r\n'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport {\r\n    Download,\r\n    Upload,\r\n    Copy,\r\n    FileText,\r\n    GitBranch,\r\n    Plus,\r\n    Settings,\r\n    Check,\r\n} from 'lucide-react';\r\nimport { PGNTree } from '@/lib/pgn-tree';\r\nimport { PGNParser, PGNOptimizer } from '@/lib/pgn-parser';\r\nimport type { MoveNode, Evaluation, NAGSymbol } from '@/lib/pgn-types';\r\nimport { VariationTree, MoveList } from './variation-tree';\r\nimport { AnnotationPanel } from './annotation-panel';\r\n\r\ninterface PGNEditorProps {\r\n    tree: PGNTree;\r\n    onTreeChange: (tree: PGNTree) => void;\r\n    onPositionChange: (fen: string) => void;\r\n    currentMove?: string; // Last move made\r\n    autoAnnotate?: boolean; // Auto-add engine evaluations\r\n    engineEval?: Evaluation | null;\r\n}\r\n\r\nexport function PGNEditor({\r\n    tree,\r\n    onTreeChange,\r\n    onPositionChange,\r\n    currentMove,\r\n    autoAnnotate = false,\r\n    engineEval,\r\n}: PGNEditorProps) {\r\n    const [viewMode, setViewMode] = useState<'tree' | 'linear'>('linear');\r\n    const [showAnnotationPanel, setShowAnnotationPanel] = useState(true);\r\n    const [copySuccess, setCopySuccess] = useState(false);\r\n\r\n    const game = tree.getGame();\r\n    const currentNode = tree.getCurrentNode();\r\n\r\n    // Auto-annotate with engine evaluation\r\n    useEffect(() => {\r\n        if (autoAnnotate && engineEval && currentNode) {\r\n            // Create new tree instance for immutability\r\n            const newTree = new PGNTree();\r\n            Object.assign(newTree, tree);\r\n            newTree.setEvaluation(engineEval);\r\n            onTreeChange(newTree);\r\n        }\r\n    }, [engineEval, currentNode?.id, autoAnnotate, tree, onTreeChange]);\r\n\r\n    // Handle node selection\r\n    const handleSelectNode = (node: MoveNode | null) => {\r\n        tree.goToNode(node);\r\n        onPositionChange(tree.getCurrentFen());\r\n        onTreeChange(tree);\r\n    };\r\n\r\n    // Handle adding comment\r\n    const handleAddComment = (text: string, position: 'before' | 'after') => {\r\n        tree.addComment(text, position);\r\n        onTreeChange(tree);\r\n    };\r\n\r\n    // Handle updating comment\r\n    const handleUpdateComment = (index: number, text: string) => {\r\n        tree.updateComment(index, text);\r\n        onTreeChange(tree);\r\n    };\r\n\r\n    // Handle removing comment\r\n    const handleRemoveComment = (index: number) => {\r\n        tree.removeComment(index);\r\n        onTreeChange(tree);\r\n    };\r\n\r\n    // Handle toggling NAG\r\n    const handleToggleNAG = (nag: NAGSymbol) => {\r\n        if (currentNode?.annotation.nags.includes(nag)) {\r\n            tree.removeNAG(nag);\r\n        } else {\r\n            tree.addNAG(nag);\r\n        }\r\n        onTreeChange(tree);\r\n    };\r\n\r\n    // Handle setting evaluation\r\n    const handleSetEvaluation = (evaluation: Evaluation | undefined) => {\r\n        if (evaluation) {\r\n            tree.setEvaluation(evaluation);\r\n        } else {\r\n            // Clear evaluation\r\n            if (currentNode) {\r\n                currentNode.annotation.evaluation = undefined;\r\n            }\r\n        }\r\n        onTreeChange(tree);\r\n    };\r\n\r\n    // Handle deleting variation\r\n    const handleDeleteVariation = (variationId: string, parentNode: MoveNode) => {\r\n        // Navigate to parent first\r\n        tree.goToNode(parentNode);\r\n        tree.deleteVariation(variationId);\r\n        onPositionChange(tree.getCurrentFen());\r\n        onTreeChange(tree);\r\n    };\r\n\r\n    // Handle promoting variation\r\n    const handlePromoteVariation = (variationId: string, parentNode: MoveNode) => {\r\n        tree.goToNode(parentNode);\r\n        tree.promoteVariation(variationId);\r\n        onTreeChange(tree);\r\n    };\r\n\r\n    // Export PGN\r\n    const handleExportPGN = () => {\r\n        const pgn = PGNParser.export(tree, {\r\n            includeVariations: true,\r\n            includeComments: true,\r\n            includeNAGs: true,\r\n            includeEvaluations: true,\r\n            includeClock: false,\r\n            maxLineLength: 80,\r\n            indentVariations: true,\r\n            sortVariations: false,\r\n        });\r\n\r\n        // Download as file\r\n        const blob = new Blob([pgn], { type: 'text/plain' });\r\n        const url = URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = `game-${Date.now()}.pgn`;\r\n        a.click();\r\n        URL.revokeObjectURL(url);\r\n    };\r\n\r\n    // Copy PGN to clipboard\r\n    const handleCopyPGN = async () => {\r\n        const pgn = PGNParser.export(tree, {\r\n            includeVariations: true,\r\n            includeComments: true,\r\n            includeNAGs: true,\r\n            includeEvaluations: true,\r\n            includeClock: false,\r\n            maxLineLength: 80,\r\n            indentVariations: true,\r\n            sortVariations: false,\r\n        });\r\n\r\n        try {\r\n            await navigator.clipboard.writeText(pgn);\r\n            setCopySuccess(true);\r\n            setTimeout(() => setCopySuccess(false), 2000);\r\n        } catch (error) {\r\n            console.error('Failed to copy PGN:', error);\r\n        }\r\n    };\r\n\r\n    // Import PGN\r\n    const handleImportPGN = () => {\r\n        const input = document.createElement('input');\r\n        input.type = 'file';\r\n        input.accept = '.pgn';\r\n        input.onchange = (e) => {\r\n            const file = (e.target as HTMLInputElement).files?.[0];\r\n            if (file) {\r\n                const reader = new FileReader();\r\n                reader.onload = (e) => {\r\n                    const pgnString = e.target?.result as string;\r\n                    try {\r\n                        const newTree = PGNParser.parse(pgnString);\r\n                        onTreeChange(newTree);\r\n                        onPositionChange(newTree.getCurrentFen());\r\n                    } catch (error) {\r\n                        console.error('Failed to import PGN:', error);\r\n                        alert('Error importing PGN file');\r\n                    }\r\n                };\r\n                reader.readAsText(file);\r\n            }\r\n        };\r\n        input.click();\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-4\">\r\n            {/* Toolbar */}\r\n            <div className=\"bg-slate-900 border border-slate-800 rounded-xl p-3 flex items-center justify-between gap-3\">\r\n                {/* View Mode Toggle */}\r\n                <div className=\"flex gap-2\">\r\n                    <button\r\n                        onClick={() => setViewMode('linear')}\r\n                        className={`px-3 py-2 rounded-lg text-sm font-medium transition flex items-center gap-2 ${viewMode === 'linear'\r\n                            ? 'bg-indigo-600 text-white'\r\n                            : 'bg-slate-800 text-slate-400 hover:bg-slate-700'\r\n                            }`}\r\n                    >\r\n                        <FileText size={16} />\r\n                        Linear\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setViewMode('tree')}\r\n                        className={`px-3 py-2 rounded-lg text-sm font-medium transition flex items-center gap-2 ${viewMode === 'tree'\r\n                            ? 'bg-indigo-600 text-white'\r\n                            : 'bg-slate-800 text-slate-400 hover:bg-slate-700'\r\n                            }`}\r\n                    >\r\n                        <GitBranch size={16} />\r\n                        Tree\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Actions */}\r\n                <div className=\"flex gap-2\">\r\n                    <button\r\n                        onClick={handleImportPGN}\r\n                        className=\"px-3 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg text-sm font-medium transition flex items-center gap-2 text-white\"\r\n                        title=\"Import PGN\"\r\n                    >\r\n                        <Upload size={16} />\r\n                        Import\r\n                    </button>\r\n                    <button\r\n                        onClick={handleCopyPGN}\r\n                        className=\"px-3 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg text-sm font-medium transition flex items-center gap-2 text-white\"\r\n                        title=\"Copy PGN\"\r\n                    >\r\n                        {copySuccess ? <Check size={16} /> : <Copy size={16} />}\r\n                        {copySuccess ? 'Copied!' : 'Copy'}\r\n                    </button>\r\n                    <button\r\n                        onClick={handleExportPGN}\r\n                        className=\"px-3 py-2 bg-indigo-600 hover:bg-indigo-500 rounded-lg text-sm font-medium transition flex items-center gap-2 text-white\"\r\n                        title=\"Export PGN\"\r\n                    >\r\n                        <Download size={16} />\r\n                        Export\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Move Display */}\r\n            <div className=\"bg-slate-900 border border-slate-800 rounded-xl overflow-hidden\">\r\n                <div className=\"bg-slate-800 border-b border-slate-700 p-3 flex items-center justify-between\">\r\n                    <h3 className=\"text-sm font-bold text-slate-200 uppercase tracking-wide\">\r\n                        Moves\r\n                    </h3>\r\n                    <div className=\"text-xs text-slate-500\">\r\n                        {game.mainLine.length} moves\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"p-4\">\r\n                    {viewMode === 'linear' ? (\r\n                        <MoveList\r\n                            moves={game.mainLine}\r\n                            currentNode={currentNode}\r\n                            onSelectNode={handleSelectNode}\r\n                        />\r\n                    ) : (\r\n                        <VariationTree\r\n                            mainLine={game.mainLine}\r\n                            currentNode={currentNode}\r\n                            onSelectNode={handleSelectNode}\r\n                            onDeleteVariation={handleDeleteVariation}\r\n                            onPromoteVariation={handlePromoteVariation}\r\n                        />\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Annotation Panel */}\r\n            {showAnnotationPanel && (\r\n                <AnnotationPanel\r\n                    node={currentNode}\r\n                    onAddComment={handleAddComment}\r\n                    onUpdateComment={handleUpdateComment}\r\n                    onRemoveComment={handleRemoveComment}\r\n                    onToggleNAG={handleToggleNAG}\r\n                    onSetEvaluation={handleSetEvaluation}\r\n                />\r\n            )}\r\n\r\n            {/* Game Info */}\r\n            {(game.metadata.white || game.metadata.black) && (\r\n                <div className=\"bg-slate-900 border border-slate-800 rounded-xl p-4\">\r\n                    <h3 className=\"text-xs font-bold text-slate-400 uppercase tracking-wide mb-3\">\r\n                        Game Information\r\n                    </h3>\r\n                    <div className=\"grid grid-cols-2 gap-3 text-sm\">\r\n                        {game.metadata.white && (\r\n                            <div>\r\n                                <div className=\"text-slate-500 text-xs\">White</div>\r\n                                <div className=\"text-slate-200 font-medium\">{game.metadata.white}</div>\r\n                            </div>\r\n                        )}\r\n                        {game.metadata.black && (\r\n                            <div>\r\n                                <div className=\"text-slate-500 text-xs\">Black</div>\r\n                                <div className=\"text-slate-200 font-medium\">{game.metadata.black}</div>\r\n                            </div>\r\n                        )}\r\n                        {game.metadata.event && (\r\n                            <div>\r\n                                <div className=\"text-slate-500 text-xs\">Event</div>\r\n                                <div className=\"text-slate-200 font-medium\">{game.metadata.event}</div>\r\n                            </div>\r\n                        )}\r\n                        {game.metadata.date && (\r\n                            <div>\r\n                                <div className=\"text-slate-500 text-xs\">Date</div>\r\n                                <div className=\"text-slate-200 font-medium\">{game.metadata.date}</div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\progress-tracker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\puzzle-solver.tsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\puzzle-solver.tsx:49:34\n  47 |     const [attempts, setAttempts] = useState(0);\n  48 |     const [hintsUsed, setHintsUsed] = useState(0);\n> 49 |     const [startTime] = useState(Date.now());\n     |                                  ^^^^^^^^^^ Cannot call impure function\n  50 |     const [isSolved, setIsSolved] = useState(false);\n  51 |     const [feedback, setFeedback] = useState<{ type: 'success' | 'error' | 'info'; message: string } | null>(null);\n  52 |     const [showHint, setShowHint] = useState(false);","line":49,"column":34,"nodeType":null,"endLine":49,"endColumn":44},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":103,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":103,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":147,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":147,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4901,4904],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4901,4904],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":157,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":157,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5236,5239],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5236,5239],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":158,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":158,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5294,5297],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5294,5297],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":197,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6692,6695],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6692,6695],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":209,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":209,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7111,7114],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7111,7114],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\puzzle-solver.tsx:338:50\n  336 |                                 <div className=\"text-xs text-slate-400\">Temps</div>\n  337 |                                 <div className=\"text-lg font-bold text-white\">\n> 338 |                                     {Math.floor((Date.now() - startTime) / 1000)}s\n      |                                                  ^^^^^^^^^^ Cannot call impure function\n  339 |                                 </div>\n  340 |                             </div>\n  341 |                         </div>","line":338,"column":50,"nodeType":null,"endLine":338,"endColumn":60},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\puzzle-solver.tsx:480:58\n  478 |                             </h3>\n  479 |                             <div className=\"text-sm text-slate-300 space-y-1\">\n> 480 |                                 <div>Temps: {Math.floor((Date.now() - startTime) / 1000)}s</div>\n      |                                                          ^^^^^^^^^^ Cannot call impure function\n  481 |                                 <div>Intents: {attempts}</div>\n  482 |                                 <div>Pistes usades: {hintsUsed}</div>\n  483 |                             </div>","line":480,"column":58,"nodeType":null,"endLine":480,"endColumn":68}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport dynamic from 'next/dynamic';\r\nimport { Chess } from 'chess.js';\r\nimport {\r\n    CheckCircle,\r\n    XCircle,\r\n    Lightbulb,\r\n    RotateCcw,\r\n    Trophy,\r\n    Clock,\r\n    Target\r\n} from 'lucide-react';\r\nimport { AcademyExercise } from '@/lib/academy-types';\r\nimport { useSettings } from '@/lib/settings';\r\nimport { BOARD_THEMES } from '@/lib/themes';\r\nimport { playSound } from '@/lib/sounds';\r\n\r\n// CR├ìTICO: Dynamic import para evitar problemas de SSR\r\nconst Chessboard = dynamic(() => import('react-chessboard').then(mod => mod.Chessboard), {\r\n    ssr: false,\r\n    loading: () => <div className=\"w-full h-full bg-slate-800 animate-pulse rounded-lg\" />\r\n});\r\n\r\ninterface PuzzleSolverProps {\r\n    exercise: AcademyExercise;\r\n    onSolved: (timeSpent: number, attempts: number, hintsUsed: number) => void;\r\n    onSkip?: () => void;\r\n}\r\n\r\nexport function PuzzleSolver({ exercise, onSolved, onSkip }: PuzzleSolverProps) {\r\n    // CR├ìTICO: Inicializar directamente con el FEN del ejercicio\r\n    const [game, setGame] = useState<Chess>(() => {\r\n        if (exercise?.fen) {\r\n            return new Chess(exercise.fen);\r\n        }\r\n        return new Chess();\r\n    });\r\n    const [fen, setFen] = useState(() => {\r\n        if (exercise?.fen) {\r\n            return exercise.fen;\r\n        }\r\n        return 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1';\r\n    });\r\n    const [moveIndex, setMoveIndex] = useState(0);\r\n    const [attempts, setAttempts] = useState(0);\r\n    const [hintsUsed, setHintsUsed] = useState(0);\r\n    const [startTime] = useState(Date.now());\r\n    const [isSolved, setIsSolved] = useState(false);\r\n    const [feedback, setFeedback] = useState<{ type: 'success' | 'error' | 'info'; message: string } | null>(null);\r\n    const [showHint, setShowHint] = useState(false);\r\n\r\n    // Click to move state\r\n    const [moveFrom, setMoveFrom] = useState<string | null>(null);\r\n    const [optionSquares, setOptionSquares] = useState<Record<string, { background: string; borderRadius?: string }>>({});\r\n\r\n    const { boardTheme } = useSettings();\r\n    const theme = BOARD_THEMES[boardTheme];\r\n\r\n    const currentTurn = game.turn() === 'w' ? 'white' : 'black';\r\n\r\n    // CR├ìTICO: Resetear completamente cuando cambia el exercise\r\n    useEffect(() => {\r\n        if (!exercise?.fen) {\r\n            console.warn('PuzzleSolver: exercise.fen no est├í disponible');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            // Crear nueva instancia de Chess con el FEN del puzzle\r\n            const newGame = new Chess(exercise.fen);\r\n            const newFen = newGame.fen();\r\n\r\n            // Actualizar estado con nuevas referencias para forzar re-render\r\n            setGame(newGame);\r\n            setFen(newFen);\r\n            setMoveIndex(0);\r\n            setAttempts(0);\r\n            setHintsUsed(0);\r\n            setIsSolved(false);\r\n            setFeedback(null);\r\n            setShowHint(false);\r\n        } catch (error) {\r\n            console.error('Error inicializando puzzle con FEN:', exercise.fen, error);\r\n        }\r\n    }, [exercise?.fen, exercise?.id]);\r\n\r\n    const handleMove = (sourceSquare: string, targetSquare: string): boolean => {\r\n        if (isSolved) return false;\r\n\r\n        // CR├ìTICO: \"Copy before Move\" pattern\r\n        const gameCopy = new Chess(game.fen());\r\n        const uciMove = `${sourceSquare}${targetSquare}`;\r\n        let result = null;\r\n\r\n        try {\r\n            result = gameCopy.move({\r\n                from: sourceSquare,\r\n                to: targetSquare,\r\n                promotion: 'q'\r\n            });\r\n        } catch (error) {\r\n            return false;\r\n        }\r\n\r\n        if (!result) return false;\r\n\r\n        setAttempts(prev => prev + 1);\r\n\r\n        const expectedMove = exercise.solution[moveIndex];\r\n\r\n        if (uciMove === expectedMove) {\r\n            // Moviment Correcte\r\n            setGame(gameCopy);\r\n            setFen(gameCopy.fen());\r\n            setMoveIndex(prev => prev + 1);\r\n            playSound('move');\r\n\r\n            if (moveIndex + 1 >= exercise.solution.length) {\r\n                solvePuzzle();\r\n            } else {\r\n                setFeedback({\r\n                    type: 'success',\r\n                    message: 'Ô£ô Correcte! Continua...'\r\n                });\r\n\r\n                setTimeout(() => {\r\n                    makeOpponentMove(gameCopy);\r\n                }, 500);\r\n            }\r\n\r\n            return true;\r\n        } else {\r\n            // Moviment Incorrecte\r\n            setFeedback({\r\n                type: 'error',\r\n                message: 'Ô£ù Aquest no ├®s el moviment correcte. Torna-ho a intentar!'\r\n            });\r\n            playSound('illegal');\r\n            return false;\r\n        }\r\n    };\r\n\r\n    function getMoveOptions(square: string) {\r\n        const moves = game.moves({\r\n            square: square as any,\r\n            verbose: true,\r\n        });\r\n        if (moves.length === 0) {\r\n            setOptionSquares({});\r\n            return false;\r\n        }\r\n\r\n        const newSquares: Record<string, { background: string; borderRadius?: string }> = {};\r\n        moves.map((move) => {\r\n            const targetPiece = game.get(move.to as any);\r\n            const sourcePiece = game.get(square as any);\r\n            const isCapture = targetPiece && sourcePiece && targetPiece.color !== sourcePiece.color;\r\n\r\n            newSquares[move.to] = {\r\n                background: isCapture\r\n                    ? 'radial-gradient(circle, rgba(255,0,0,.5) 25%, transparent 25%)'\r\n                    : 'radial-gradient(circle, rgba(0,0,0,.5) 25%, transparent 25%)',\r\n                borderRadius: '50%',\r\n            };\r\n            return move;\r\n        });\r\n        newSquares[square] = {\r\n            background: 'rgba(255, 255, 0, 0.4)',\r\n        };\r\n        setOptionSquares(newSquares);\r\n        return true;\r\n    }\r\n\r\n    function onSquareClick(square: string) {\r\n        if (isSolved) return;\r\n\r\n        // If we have a moveFrom, try to move to the clicked square\r\n        if (moveFrom) {\r\n            // If clicked on the same square, deselect\r\n            if (moveFrom === square) {\r\n                setMoveFrom(null);\r\n                setOptionSquares({});\r\n                return;\r\n            }\r\n\r\n            // Attempt move\r\n            const moveResult = handleMove(moveFrom, square);\r\n            if (moveResult) {\r\n                setMoveFrom(null);\r\n                setOptionSquares({});\r\n                return;\r\n            }\r\n\r\n            // If move failed, check if we clicked on another piece of our own to select it instead\r\n            const clickedPiece = game.get(square as any);\r\n            if (clickedPiece && clickedPiece.color === game.turn()) {\r\n                setMoveFrom(square);\r\n                getMoveOptions(square);\r\n                return;\r\n            }\r\n\r\n            // Otherwise, just deselect\r\n            setMoveFrom(null);\r\n            setOptionSquares({});\r\n        } else {\r\n            // No piece selected, try to select\r\n            const piece = game.get(square as any);\r\n            if (piece && piece.color === game.turn()) {\r\n                setMoveFrom(square);\r\n                getMoveOptions(square);\r\n            }\r\n        }\r\n    }\r\n\r\n    const makeOpponentMove = (baseGame: Chess) => {\r\n        const nextMoveIndex = moveIndex + 1;\r\n        if (nextMoveIndex < exercise.solution.length) {\r\n            const opponentMove = exercise.solution[nextMoveIndex];\r\n            const from = opponentMove.substring(0, 2);\r\n            const to = opponentMove.substring(2, 4);\r\n\r\n            // CR├ìTICO: Crear nova c├▓pia per al moviment del rival\r\n            const gameCopy = new Chess(baseGame.fen());\r\n\r\n            try {\r\n                const result = gameCopy.move({\r\n                    from,\r\n                    to,\r\n                    promotion: 'q'\r\n                });\r\n\r\n                if (result) {\r\n                    setGame(gameCopy);\r\n                    setFen(gameCopy.fen());\r\n                    setMoveIndex(prev => prev + 2);\r\n                    playSound('move');\r\n\r\n                    if (nextMoveIndex + 1 >= exercise.solution.length) {\r\n                        setTimeout(() => solvePuzzle(), 500);\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                console.error('Error making opponent move:', error);\r\n            }\r\n        }\r\n    };\r\n\r\n    const solvePuzzle = () => {\r\n        const timeSpent = Math.floor((Date.now() - startTime) / 1000);\r\n        setIsSolved(true);\r\n        setFeedback({\r\n            type: 'success',\r\n            message: '­ƒÄë Puzzle resolt correctament!'\r\n        });\r\n        playSound('game_end');\r\n        onSolved(timeSpent, attempts, hintsUsed);\r\n    };\r\n\r\n    const resetPuzzle = () => {\r\n        const newGame = new Chess(exercise.fen);\r\n        setGame(newGame);\r\n        setFen(exercise.fen);\r\n        setMoveIndex(0);\r\n        setFeedback(null);\r\n        setShowHint(false);\r\n    };\r\n\r\n    const toggleHint = () => {\r\n        if (!showHint) {\r\n            setHintsUsed(prev => prev + 1);\r\n        }\r\n        setShowHint(!showHint);\r\n    };\r\n\r\n    const getHintText = () => {\r\n        if (moveIndex >= exercise.solution.length) return '';\r\n\r\n        const nextMove = exercise.solution[moveIndex];\r\n        const from = nextMove.substring(0, 2);\r\n\r\n        return `Pista: Busca un moviment des de ${from.toUpperCase()}`;\r\n    };\r\n\r\n    const getDifficultyColor = () => {\r\n        switch (exercise.difficulty) {\r\n            case 'easy': return 'text-emerald-400 bg-emerald-900/30 border-emerald-500/30';\r\n            case 'medium': return 'text-amber-400 bg-amber-900/30 border-amber-500/30';\r\n            case 'hard': return 'text-red-400 bg-red-900/30 border-red-500/30';\r\n            default: return 'text-slate-400 bg-slate-900/30 border-slate-500/30';\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"w-full max-w-6xl mx-auto p-4\">\r\n            <div className=\"flex flex-col lg:flex-row gap-6\">\r\n\r\n                <div className=\"flex-1\">\r\n                    <div className=\"relative w-full max-w-[600px] aspect-square mx-auto shadow-2xl rounded-lg overflow-hidden border-4 border-slate-800 bg-slate-900\">\r\n                        <Chessboard\r\n                            id={`puzzle-${exercise.id}`}\r\n                            key={exercise.id} // CR├ìTICO: For├ºa re-render quan canvia l'exercici\r\n                            position={fen}\r\n                            onPieceDrop={({ sourceSquare, targetSquare }) => {\r\n                                if (!targetSquare) {\r\n                                    return false;\r\n                                }\r\n                                const result = handleMove(sourceSquare, targetSquare);\r\n                                return result === true;\r\n                            }}\r\n                            boardOrientation={currentTurn}\r\n                            customDarkSquareStyle={{ backgroundColor: theme.dark }}\r\n                            customLightSquareStyle={{ backgroundColor: theme.light }}\r\n                            arePiecesDraggable={!isSolved}\r\n                            onSquareClick={onSquareClick}\r\n                            onSquareRightClick={() => {\r\n                                setMoveFrom(null);\r\n                                setOptionSquares({});\r\n                            }}\r\n                            customSquareStyles={optionSquares}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"mt-4 max-w-[600px] mx-auto flex gap-4\">\r\n                        <div className=\"flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex items-center gap-2\">\r\n                            <Target className=\"text-indigo-400\" size={20} />\r\n                            <div>\r\n                                <div className=\"text-xs text-slate-400\">Intents</div>\r\n                                <div className=\"text-lg font-bold text-white\">{attempts}</div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex items-center gap-2\">\r\n                            <Clock className=\"text-amber-400\" size={20} />\r\n                            <div>\r\n                                <div className=\"text-xs text-slate-400\">Temps</div>\r\n                                <div className=\"text-lg font-bold text-white\">\r\n                                    {Math.floor((Date.now() - startTime) / 1000)}s\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex items-center gap-2\">\r\n                            <Lightbulb className=\"text-emerald-400\" size={20} />\r\n                            <div>\r\n                                <div className=\"text-xs text-slate-400\">Pistes</div>\r\n                                <div className=\"text-lg font-bold text-white\">{hintsUsed}</div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"w-full lg:w-96 flex flex-col gap-4\">\r\n\r\n                    <div className=\"bg-slate-900 border border-slate-800 rounded-xl p-6\">\r\n                        <div className=\"flex items-start justify-between mb-3\">\r\n                            <div>\r\n                                <h2 className=\"text-xl font-bold text-white mb-1\">\r\n                                    {exercise.title || 'Puzzle T├áctic'}\r\n                                </h2>\r\n                                {exercise.description && (\r\n                                    <p className=\"text-slate-400 text-sm\">{exercise.description}</p>\r\n                                )}\r\n                            </div>\r\n                            <span className={`text-xs font-bold px-3 py-1 rounded-full border ${getDifficultyColor()}`}>\r\n                                {exercise.difficulty === 'easy' ? 'F├ácil' : exercise.difficulty === 'medium' ? 'Mitj├á' : 'Dif├¡cil'}\r\n                            </span>\r\n                        </div>\r\n\r\n                        {exercise.tags && exercise.tags.length > 0 && (\r\n                            <div className=\"flex flex-wrap gap-2 mt-3\">\r\n                                {exercise.tags.map((tag, idx) => (\r\n                                    <span\r\n                                        key={idx}\r\n                                        className=\"text-xs px-2 py-1 bg-slate-800 text-slate-300 rounded border border-slate-700\"\r\n                                    >\r\n                                        {tag}\r\n                                    </span>\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n\r\n                        <div className=\"mt-4 pt-4 border-t border-slate-800\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <Trophy className=\"text-amber-400\" size={16} />\r\n                                <span className=\"text-sm text-slate-400\">\r\n                                    Rating: <span className=\"text-white font-bold\">{exercise.rating}</span>\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"bg-slate-900 border border-slate-800 rounded-xl p-6\">\r\n                        <div className=\"flex items-start gap-3 mb-4\">\r\n                            <Target className=\"text-indigo-400 mt-1\" size={20} />\r\n                            <div>\r\n                                <h3 className=\"text-sm font-bold text-slate-400 uppercase tracking-wider mb-2\">\r\n                                    Objectiu\r\n                                </h3>\r\n                                <p className=\"text-white text-base\">\r\n                                    {currentTurn === 'white' ? 'Les blanques' : 'Les negres'} mouen i guanyen.\r\n                                </p>\r\n                                <p className=\"text-slate-400 text-sm mt-2\">\r\n                                    Troba la millor seq├╝├¿ncia de moviments.\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {!isSolved && (\r\n                            <button\r\n                                onClick={toggleHint}\r\n                                className=\"text-sm text-indigo-400 hover:text-indigo-300 flex items-center gap-2 transition\"\r\n                            >\r\n                                <Lightbulb size={16} />\r\n                                {showHint ? 'Amagar pista' : 'Mostrar pista'}\r\n                            </button>\r\n                        )}\r\n\r\n                        {showHint && (\r\n                            <div className=\"mt-3 p-3 bg-indigo-900/20 border border-indigo-500/30 rounded-lg\">\r\n                                <p className=\"text-sm text-indigo-200\">\r\n                                    {getHintText()}\r\n                                </p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {feedback && (\r\n                        <div className={`border rounded-xl p-4 ${feedback.type === 'success'\r\n                            ? 'bg-emerald-900/20 border-emerald-500/30'\r\n                            : feedback.type === 'error'\r\n                                ? 'bg-red-900/20 border-red-500/30'\r\n                                : 'bg-blue-900/20 border-blue-500/30'\r\n                            }`}>\r\n                            <div className=\"flex items-start gap-3\">\r\n                                {feedback.type === 'success' ? (\r\n                                    <CheckCircle className=\"text-emerald-400 mt-0.5\" size={20} />\r\n                                ) : feedback.type === 'error' ? (\r\n                                    <XCircle className=\"text-red-400 mt-0.5\" size={20} />\r\n                                ) : (\r\n                                    <Lightbulb className=\"text-blue-400 mt-0.5\" size={20} />\r\n                                )}\r\n                                <p className={`text-sm ${feedback.type === 'success'\r\n                                    ? 'text-emerald-200'\r\n                                    : feedback.type === 'error'\r\n                                        ? 'text-red-200'\r\n                                        : 'text-blue-200'\r\n                                    }`}>\r\n                                    {feedback.message}\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    <div className=\"flex gap-3\">\r\n                        <button\r\n                            onClick={resetPuzzle}\r\n                            className=\"flex-1 bg-slate-800 hover:bg-slate-700 text-white py-3 rounded-lg font-bold flex items-center justify-center gap-2 transition\"\r\n                        >\r\n                            <RotateCcw size={20} />\r\n                            Reiniciar\r\n                        </button>\r\n\r\n                        {onSkip && !isSolved && (\r\n                            <button\r\n                                onClick={onSkip}\r\n                                className=\"flex-1 bg-slate-800 hover:bg-slate-700 text-white py-3 rounded-lg font-bold transition\"\r\n                            >\r\n                                Saltar\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n\r\n                    {isSolved && (\r\n                        <div className=\"bg-gradient-to-r from-emerald-900/40 to-green-900/40 border border-emerald-500/50 rounded-xl p-6 text-center\">\r\n                            <Trophy className=\"text-amber-400 mx-auto mb-3\" size={48} />\r\n                            <h3 className=\"text-xl font-bold text-white mb-2\">\r\n                                Puzzle Resolt!\r\n                            </h3>\r\n                            <div className=\"text-sm text-slate-300 space-y-1\">\r\n                                <div>Temps: {Math.floor((Date.now() - startTime) / 1000)}s</div>\r\n                                <div>Intents: {attempts}</div>\r\n                                <div>Pistes usades: {hintsUsed}</div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\settings-panel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\shop\\cart-button.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\shop\\cart-button.tsx:20:9\n  18 |\n  19 |     useEffect(() => {\n> 20 |         setMounted(true);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  21 |         loadCart();\n  22 |     }, [loadCart]);\n  23 |","line":20,"column":9,"nodeType":null,"endLine":20,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport Link from 'next/link';\r\nimport Image from 'next/image';\r\nimport { ShoppingCart, X } from 'lucide-react';\r\nimport { useCartStore } from '@/lib/cart-store';\r\nimport { formatPrice } from '@/lib/ecommerce-types';\r\nimport { useEffect, useState } from 'react';\r\n\r\nexport function CartButton() {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const [mounted, setMounted] = useState(false);\r\n    const items = useCartStore(state => state.items);\r\n    const itemCount = useCartStore(state => state.itemCount);\r\n    const subtotal = useCartStore(state => state.subtotal);\r\n    const removeItem = useCartStore(state => state.removeItem);\r\n    const loadCart = useCartStore(state => state.loadCart);\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        loadCart();\r\n    }, [loadCart]);\r\n\r\n    if (!mounted) {\r\n        return (\r\n            <button className=\"relative p-2 text-slate-400 hover:text-emerald-400 transition-colors\">\r\n                <ShoppingCart size={24} />\r\n            </button>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"relative\">\r\n            {/* Cart Button */}\r\n            <button\r\n                onClick={() => setIsOpen(!isOpen)}\r\n                className=\"relative p-2 text-slate-400 hover:text-emerald-400 transition-colors\"\r\n            >\r\n                <ShoppingCart size={24} />\r\n                {itemCount > 0 && (\r\n                    <span className=\"absolute -top-1 -right-1 bg-emerald-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse\">\r\n                        {itemCount}\r\n                    </span>\r\n                )}\r\n            </button>\r\n\r\n            {/* Dropdown Mini Cart */}\r\n            {isOpen && (\r\n                <>\r\n                    {/* Backdrop */}\r\n                    <div\r\n                        className=\"fixed inset-0 z-40\"\r\n                        onClick={() => setIsOpen(false)}\r\n                    />\r\n\r\n                    {/* Dropdown */}\r\n                    <div className=\"absolute right-0 mt-2 w-80 bg-slate-900 border border-slate-800 rounded-lg shadow-xl z-50 max-h-96 overflow-hidden flex flex-col\">\r\n                        {items.length === 0 ? (\r\n                            <div className=\"p-6 text-center text-slate-400\">\r\n                                <ShoppingCart size={48} className=\"mx-auto mb-2 opacity-50\" />\r\n                                <p>La teva cistella est├á buida</p>\r\n                            </div>\r\n                        ) : (\r\n                            <>\r\n                                {/* Items List */}\r\n                                <div className=\"flex-1 overflow-y-auto p-4 space-y-3\">\r\n                                    {items.map((item) => (\r\n                                        <div key={item.id} className=\"flex gap-3 bg-slate-800/50 p-2 rounded\">\r\n                                            {/* Image */}\r\n                                            <div className=\"w-16 h-16 bg-slate-700 rounded flex-shrink-0 relative overflow-hidden\">\r\n                                                {item.product?.images && item.product.images.length > 0 ? (\r\n                                                    <Image\r\n                                                        src={item.product.images[0]}\r\n                                                        alt={item.product.name}\r\n                                                        fill\r\n                                                        className=\"object-cover rounded\"\r\n                                                        sizes=\"64px\"\r\n                                                    />\r\n                                                ) : (\r\n                                                    <div className=\"w-full h-full flex items-center justify-center\">\r\n                                                        <ShoppingCart size={24} className=\"text-slate-600\" />\r\n                                                    </div>\r\n                                                )}\r\n                                            </div>\r\n\r\n                                            {/* Info */}\r\n                                            <div className=\"flex-1 min-w-0\">\r\n                                                <h4 className=\"text-sm font-medium text-slate-200 truncate\">\r\n                                                    {item.product?.name}\r\n                                                </h4>\r\n                                                <p className=\"text-xs text-slate-400\">\r\n                                                    Quantitat: {item.quantity}\r\n                                                </p>\r\n                                                <p className=\"text-sm font-semibold text-emerald-400\">\r\n                                                    {formatPrice((item.product?.sale_price || item.product?.price || 0) * item.quantity)}\r\n                                                </p>\r\n                                            </div>\r\n\r\n                                            {/* Remove Button */}\r\n                                            <button\r\n                                                onClick={() => removeItem(item.product_id)}\r\n                                                className=\"text-slate-400 hover:text-red-400 transition-colors\"\r\n                                            >\r\n                                                <X size={18} />\r\n                                            </button>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n\r\n                                {/* Footer */}\r\n                                <div className=\"border-t border-slate-800 p-4 space-y-3\">\r\n                                    <div className=\"flex justify-between text-sm\">\r\n                                        <span className=\"text-slate-400\">Subtotal:</span>\r\n                                        <span className=\"font-semibold text-emerald-400\">{formatPrice(subtotal)}</span>\r\n                                    </div>\r\n\r\n                                    <Link\r\n                                        href=\"/shop/cart\"\r\n                                        onClick={() => setIsOpen(false)}\r\n                                        className=\"block w-full bg-emerald-600 hover:bg-emerald-500 text-white text-center py-2 px-4 rounded-lg font-medium transition-colors\"\r\n                                    >\r\n                                        Veure cistella\r\n                                    </Link>\r\n                                </div>\r\n                            </>\r\n                        )}\r\n                    </div>\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\shop\\product-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\site-header.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Shield' is defined but never used.","line":6,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":47}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport Link from 'next/link';\r\nimport Image from 'next/image';\r\nimport { useAuth, useRBAC } from '@/components/auth-provider';\r\nimport { Trophy, LogOut, User, Loader2, Shield } from 'lucide-react';\r\nimport { CartButton } from '@/components/shop/cart-button';\r\n\r\nexport function SiteHeader() {\r\n  const { user, loading, signOut } = useAuth();\r\n  const { checkPermission } = useRBAC();\r\n\r\n  return (\r\n    <header className=\"w-full bg-slate-900 border-b border-slate-800 sticky top-0 z-50\">\r\n      <div className=\"max-w-6xl mx-auto px-4 h-16 flex items-center justify-between\">\r\n        {/* LOGO - Sempre et porta a l'inici */}\r\n        <Link href=\"/\" className=\"flex items-center gap-2 hover:opacity-80 transition\">\r\n          <Trophy className=\"text-indigo-500\" size={28} />\r\n          <span className=\"text-xl font-bold text-white tracking-tight\">ChessHub</span>\r\n        </Link>\r\n\r\n        {/* NAVIGATION */}\r\n        <nav className=\"hidden md:flex items-center gap-6\">\r\n          <Link href=\"/shop\" className=\"text-slate-300 hover:text-emerald-400 transition font-medium\">\r\n            Botiga\r\n          </Link>\r\n          <Link href=\"/academy\" className=\"text-slate-300 hover:text-indigo-400 transition font-medium\">\r\n            Acad├¿mia\r\n          </Link>\r\n          <Link href=\"/play\" className=\"text-slate-300 hover:text-purple-400 transition font-medium\">\r\n            Jugar\r\n          </Link>\r\n          {checkPermission('view.clubs') && (\r\n            <Link href=\"/clubs\" className=\"text-slate-300 hover:text-purple-400 transition font-medium\">\r\n              Clubs\r\n            </Link>\r\n          )}\r\n        </nav>\r\n\r\n        {/* ZONA D'USUARI */}\r\n        <div className=\"flex items-center gap-4\">\r\n          {/* Cart Button - Always visible */}\r\n          <CartButton />\r\n\r\n          {loading ? (\r\n            <Loader2 className=\"animate-spin text-slate-500\" size={20} />\r\n          ) : user ? (\r\n            <>\r\n              {/* Nom├®s visible si est├ás loguejat */}\r\n              <Link href=\"/profile\" className=\"flex items-center gap-2 text-slate-300 hover:text-white transition bg-slate-800/50 px-3 py-1.5 rounded-full border border-slate-700 hover:border-indigo-500/50\">\r\n                {user.user_metadata?.avatar_url ? (\r\n                  <Image\r\n                    src={user.user_metadata.avatar_url}\r\n                    width={24}\r\n                    height={24}\r\n                    className=\"w-6 h-6 rounded-full\"\r\n                    alt=\"Avatar\"\r\n                  />\r\n                ) : (\r\n                  <User size={18} />\r\n                )}\r\n                <span className=\"text-sm font-medium hidden sm:inline\">\r\n                  {user.user_metadata?.full_name || 'Perfil'}\r\n                </span>\r\n              </Link>\r\n\r\n              <button\r\n                onClick={signOut}\r\n                className=\"text-slate-400 hover:text-red-400 transition p-2 hover:bg-slate-800 rounded-full\"\r\n                title=\"Tancar Sessi├│\"\r\n              >\r\n                <LogOut size={20} />\r\n              </button>\r\n            </>\r\n          ) : (\r\n            /* Si no est├ás loguejat, nom├®s veus bot├│ d'Entrar */\r\n            <Link href=\"/login\">\r\n              <button className=\"px-4 py-2 text-sm font-bold bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition shadow-lg shadow-indigo-900/20\">\r\n                Iniciar Sessi├│\r\n              </button>\r\n            </Link>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </header>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\smart-chessboard.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\smart-chessboard.tsx:65:9\n  63 |     const [mounted, setMounted] = useState(false);\n  64 |     useEffect(() => {\n> 65 |         setMounted(true);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  66 |     }, []);\n  67 |\n  68 |     if (!mounted) return <div className=\"w-full aspect-square bg-gray-100 rounded-lg animate-pulse\" />;","line":65,"column":9,"nodeType":null,"endLine":65,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":75,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3001,3004],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3001,3004],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useCallback, useEffect } from 'react';\r\nimport { Chess } from 'chess.js';\r\nimport { Chessboard } from 'react-chessboard';\r\n\r\ninterface SmartChessboardProps {\r\n    initialFen?: string;\r\n    onMove?: (fen: string) => void;\r\n    boardOrientation?: 'white' | 'black';\r\n}\r\n\r\nexport default function SmartChessboard({\r\n    initialFen = 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1',\r\n    onMove,\r\n    boardOrientation = 'white'\r\n}: SmartChessboardProps) {\r\n\r\n    // 1. SETUP SEGUR: Utilitzem una funci├│ d'inicialitzaci├│ per evitar\r\n    // que el Strict Mode de React 19 cre├» dues inst├áncies del joc.\r\n    const [game, setGame] = useState(() => new Chess(initialFen));\r\n\r\n    // Estat per for├ºar el re-renderitzat visual quan l'estat intern canvia\r\n    const [fen, setFen] = useState(initialFen);\r\n\r\n    // 2. CORRECCI├ô DE L'ERROR DE MOVIMENT (Chess.js v1 vs React)\r\n    // Adaptem la signatura a la que espera react-chessboard\r\n    const onDrop = useCallback((sourceSquare: string, targetSquare: string) => {\r\n        if (!targetSquare) return false;\r\n\r\n        try {\r\n            // Important: Treballem sobre una c├▓pia per no mutar l'estat directament\r\n            // aix├▓ ajuda a React a detectar els canvis.\r\n            const gameCopy = new Chess(game.fen());\r\n\r\n            // A la versi├│ v1 de chess.js, .move() llan├ºa una excepci├│ si el moviment ├®s il┬Àlegal\r\n            // en lloc de retornar null. Per aix├▓ necessitem el bloc try/catch.\r\n            const move = gameCopy.move({\r\n                from: sourceSquare,\r\n                to: targetSquare,\r\n                promotion: 'q', // Per defecte promocionem a Dama per simplificar\r\n            });\r\n\r\n            // Si arribem aqu├¡, el moviment ├®s legal\r\n            if (move) {\r\n                setGame(gameCopy);\r\n                setFen(gameCopy.fen());\r\n\r\n                // Notifiquem al pare si cal (per guardar a DB, etc)\r\n                if (onMove) onMove(gameCopy.fen());\r\n\r\n                return true; // Retornar true diu a react-chessboard que deixi la pe├ºa a la nova casella\r\n            }\r\n        } catch {\r\n            // Silenciem l'error de \"moviment il┬Àlegal\" per evitar que l'app peti\r\n            return false; // Retornar false fa que la pe├ºa torni a la seva casella original\r\n        }\r\n        return false;\r\n    }, [game, onMove]);\r\n\r\n    // 3. PROTECCI├ô CONTRA HIDRATACI├ô (Hydration Mismatch)\r\n    // Ens assegurem que el component nom├®s es mostri quan el client est├á llest\r\n    const [mounted, setMounted] = useState(false);\r\n    useEffect(() => {\r\n        setMounted(true);\r\n    }, []);\r\n\r\n    if (!mounted) return <div className=\"w-full aspect-square bg-gray-100 rounded-lg animate-pulse\" />;\r\n\r\n    return (\r\n        <div className=\"w-full max-w-[600px] mx-auto shadow-xl rounded-lg overflow-hidden border-4 border-slate-700\">\r\n            <Chessboard\r\n                id=\"SmartBoard\"\r\n                position={fen}\r\n                onPieceDrop={onDrop as any}\r\n                boardOrientation={boardOrientation}\r\n                // Personalitzaci├│ visual per fer-ho \"Super App\"\r\n                customDarkSquareStyle={{ backgroundColor: '#779954' }}\r\n                customLightSquareStyle={{ backgroundColor: '#e9edcc' }}\r\n                animationDurationInMs={200}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\ui\\avatar.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":22,"column":9,"nodeType":"JSXOpeningElement","endLine":26,"endColumn":11},{"ruleId":"jsx-a11y/alt-text","severity":1,"message":"img elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","line":22,"column":9,"nodeType":"JSXOpeningElement","endLine":26,"endColumn":11}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Avatar = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\r\n    ({ className, ...props }, ref) => (\r\n        <div\r\n            ref={ref}\r\n            className={cn(\r\n                \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\r\n                className\r\n            )}\r\n            {...props}\r\n        />\r\n    )\r\n)\r\nAvatar.displayName = \"Avatar\"\r\n\r\nconst AvatarImage = React.forwardRef<HTMLImageElement, React.ImgHTMLAttributes<HTMLImageElement>>(\r\n    ({ className, ...props }, ref) => (\r\n        <img\r\n            ref={ref}\r\n            className={cn(\"aspect-square h-full w-full\", className)}\r\n            {...props}\r\n        />\r\n    )\r\n)\r\nAvatarImage.displayName = \"AvatarImage\"\r\n\r\nconst AvatarFallback = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\r\n    ({ className, ...props }, ref) => (\r\n        <div\r\n            ref={ref}\r\n            className={cn(\r\n                \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\r\n                className\r\n            )}\r\n            {...props}\r\n        />\r\n    )\r\n)\r\nAvatarFallback.displayName = \"AvatarFallback\"\r\n\r\nexport { Avatar, AvatarImage, AvatarFallback }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\ui\\dialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1145,1148],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1145,1148],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1238,1241],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1238,1241],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport { X } from \"lucide-react\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst DialogContext = React.createContext<{\r\n    open: boolean\r\n    onOpenChange: (open: boolean) => void\r\n}>({ open: false, onOpenChange: () => { } })\r\n\r\nconst Dialog = ({ children, open, onOpenChange }: { children: React.ReactNode, open?: boolean, onOpenChange?: (open: boolean) => void }) => {\r\n    const [internalOpen, setInternalOpen] = React.useState(false)\r\n    const isControlled = open !== undefined\r\n    const finalOpen = isControlled ? open : internalOpen\r\n    const finalOnOpenChange = isControlled ? onOpenChange : setInternalOpen\r\n\r\n    return (\r\n        <DialogContext.Provider value={{ open: !!finalOpen, onOpenChange: finalOnOpenChange || (() => { }) }}>\r\n            {children}\r\n        </DialogContext.Provider>\r\n    )\r\n}\r\n\r\nconst DialogTrigger = ({ children, asChild }: { children: React.ReactNode, asChild?: boolean }) => {\r\n    const { onOpenChange } = React.useContext(DialogContext)\r\n    if (asChild && React.isValidElement(children)) {\r\n        return React.cloneElement(children as React.ReactElement<any>, {\r\n            onClick: (e: React.MouseEvent) => {\r\n                (children.props as any).onClick?.(e)\r\n                onOpenChange(true)\r\n            }\r\n        })\r\n    }\r\n    return <button onClick={() => onOpenChange(true)}>{children}</button>\r\n}\r\n\r\nconst DialogContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, children, ...props }, ref) => {\r\n    const { open, onOpenChange } = React.useContext(DialogContext)\r\n    if (!open) return null\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4\">\r\n            <div\r\n                ref={ref}\r\n                className={cn(\"bg-background rounded-lg shadow-lg w-full max-w-lg relative border p-0\", className)}\r\n                {...props}\r\n            >\r\n                <button\r\n                    onClick={() => onOpenChange(false)}\r\n                    className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground z-10\"\r\n                >\r\n                    <X className=\"h-4 w-4 text-white\" />\r\n                    <span className=\"sr-only\">Close</span>\r\n                </button>\r\n                {children}\r\n            </div>\r\n        </div>\r\n    )\r\n})\r\nDialogContent.displayName = \"DialogContent\"\r\n\r\nconst DialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (\r\n    <div className={cn(\"flex flex-col space-y-1.5 p-6\", className)} {...props} />\r\n)\r\nDialogHeader.displayName = \"DialogHeader\"\r\n\r\nconst DialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (\r\n    <div className={cn(\"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 p-6 pt-0\", className)} {...props} />\r\n)\r\nDialogFooter.displayName = \"DialogFooter\"\r\n\r\nconst DialogTitle = React.forwardRef<HTMLHeadingElement, React.HTMLAttributes<HTMLHeadingElement>>(({ className, ...props }, ref) => (\r\n    <h2 ref={ref} className={cn(\"text-lg font-semibold leading-none tracking-tight\", className)} {...props} />\r\n))\r\nDialogTitle.displayName = \"DialogTitle\"\r\n\r\nconst DialogDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(({ className, ...props }, ref) => (\r\n    <p ref={ref} className={cn(\"text-sm text-muted-foreground\", className)} {...props} />\r\n))\r\nDialogDescription.displayName = \"DialogDescription\"\r\n\r\nexport { Dialog, DialogTrigger, DialogContent, DialogHeader, DialogFooter, DialogTitle, DialogDescription }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\ui\\input.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":4,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":4,"endColumn":28,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[75,156],"text":"type InputProps = React.InputHTMLAttributes<HTMLInputElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface InputProps\r\n    extends React.InputHTMLAttributes<HTMLInputElement> { }\r\n\r\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\r\n    ({ className, type, ...props }, ref) => {\r\n        return (\r\n            <input\r\n                type={type}\r\n                className={cn(\r\n                    \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n                    className\r\n                )}\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        )\r\n    }\r\n)\r\nInput.displayName = \"Input\"\r\n\r\nexport { Input }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\ui\\select.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":95,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3959,3962],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3959,3962],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":96,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4019,4022],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4019,4022],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport { ChevronDown } from \"lucide-react\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst SelectContext = React.createContext<{\r\n    value?: string\r\n    onValueChange?: (value: string) => void\r\n    open: boolean\r\n    setOpen: (open: boolean) => void\r\n}>({ open: false, setOpen: () => { } })\r\n\r\nconst Select = ({ children, value, onValueChange }: { children: React.ReactNode, value?: string, onValueChange?: (value: string) => void }) => {\r\n    const [open, setOpen] = React.useState(false)\r\n    return (\r\n        <SelectContext.Provider value={{ value, onValueChange, open, setOpen }}>\r\n            <div className=\"relative\">{children}</div>\r\n        </SelectContext.Provider>\r\n    )\r\n}\r\n\r\nconst SelectTrigger = React.forwardRef<HTMLButtonElement, React.ButtonHTMLAttributes<HTMLButtonElement>>(({ className, children, ...props }, ref) => {\r\n    const { setOpen, open } = React.useContext(SelectContext)\r\n    return (\r\n        <button\r\n            ref={ref}\r\n            onClick={() => setOpen(!open)}\r\n            className={cn(\r\n                \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n                className\r\n            )}\r\n            {...props}\r\n        >\r\n            {children}\r\n            <ChevronDown className=\"h-4 w-4 opacity-50\" />\r\n        </button>\r\n    )\r\n})\r\nSelectTrigger.displayName = \"SelectTrigger\"\r\n\r\nconst SelectValue = React.forwardRef<HTMLSpanElement, React.HTMLAttributes<HTMLSpanElement> & { placeholder?: string }>(({ className, placeholder, ...props }, ref) => {\r\n    const { value } = React.useContext(SelectContext)\r\n    return (\r\n        <span ref={ref} className={cn(\"block truncate\", className)} {...props}>\r\n            {value || placeholder}\r\n        </span>\r\n    )\r\n})\r\nSelectValue.displayName = \"SelectValue\"\r\n\r\nconst SelectContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement> & { position?: \"popper\" | \"item-aligned\" }>(({ className, children, position = \"popper\", ...props }, ref) => {\r\n    const { open } = React.useContext(SelectContext)\r\n    if (!open) return null\r\n    return (\r\n        <div\r\n            ref={ref}\r\n            className={cn(\r\n                \"absolute z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md animate-in fade-in-80 bg-neutral-800 mt-1\",\r\n                position === \"popper\" && \"translate-y-1\",\r\n                className\r\n            )}\r\n            {...props}\r\n        >\r\n            <div className=\"p-1\">{children}</div>\r\n        </div>\r\n    )\r\n})\r\nSelectContent.displayName = \"SelectContent\"\r\n\r\nconst SelectItem = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement> & { value: string }>(({ className, children, value, ...props }, ref) => {\r\n    const { onValueChange, setOpen } = React.useContext(SelectContext)\r\n    return (\r\n        <div\r\n            ref={ref}\r\n            onClick={() => {\r\n                onValueChange?.(value)\r\n                setOpen(false)\r\n            }}\r\n            className={cn(\r\n                \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 hover:bg-neutral-700 cursor-pointer text-white\",\r\n                className\r\n            )}\r\n            {...props}\r\n        >\r\n            <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\r\n                {/* Check icon could go here */}\r\n            </span>\r\n            <span className=\"truncate\">{children}</span>\r\n        </div>\r\n    )\r\n})\r\nSelectItem.displayName = \"SelectItem\"\r\n\r\nconst SelectGroup = ({ children }: any) => <>{children}</>\r\nconst SelectLabel = ({ children }: any) => <div className=\"py-1.5 pl-8 pr-2 text-sm font-semibold\">{children}</div>\r\nconst SelectSeparator = () => <div className=\"-mx-1 my-1 h-px bg-muted\" />\r\n\r\nexport { Select, SelectGroup, SelectValue, SelectTrigger, SelectContent, SelectLabel, SelectItem, SelectSeparator }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\ui\\tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\ui\\textarea.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":4,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":4,"endColumn":31,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[75,165],"text":"type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface TextareaProps\r\n    extends React.TextareaHTMLAttributes<HTMLTextAreaElement> { }\r\n\r\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\r\n    ({ className, ...props }, ref) => {\r\n        return (\r\n            <textarea\r\n                className={cn(\r\n                    \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n                    className\r\n                )}\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        )\r\n    }\r\n)\r\nTextarea.displayName = \"Textarea\"\r\n\r\nexport { Textarea }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Marc\\Desktop\\chess-super-app\\chess-super-app\\components\\variation-tree.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
